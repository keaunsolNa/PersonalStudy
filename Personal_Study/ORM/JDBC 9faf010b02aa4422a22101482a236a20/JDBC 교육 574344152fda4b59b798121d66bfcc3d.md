# JDBC êµìœ¡

<aside>
ğŸ’¡ JDBCëŠ” ë‹¤ì–‘í•œ DMBSì™€ í†µì‹ í•  ë•Œ ì„œë¡œ ë‹¤ë¥¸ ë°©ì‹ì˜ ì»¨ë²„íŒ… ê³¼ì •ì„ ê±°ì¹˜ì§€ ì•Šê³ , JDBC DRIVERë¥¼ í†µí•´ ì»¨ë²„íŒ…í•˜ê¸° ìœ„í•œ ê²ƒì´ ê·¸ ë³¸ì§ˆì´ë‹¤.

</aside>

# 1. ORIENTATION

- JDBCë€?
    - Java DataBase Connectivity): ìë°”ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” Programming API
        
        ![Untitled](JDBC%20%E1%84%80%E1%85%AD%E1%84%8B%E1%85%B2%E1%86%A8%20574344152fda4b59b798121d66bfcc3d/Untitled.png)
        
        ![Untitled](JDBC%20%E1%84%80%E1%85%AD%E1%84%8B%E1%85%B2%E1%86%A8%20574344152fda4b59b798121d66bfcc3d/Untitled%201.png)
        
    - ìˆ˜ì—…ì—ì„œëŠ” Oracle JDBC Driverë¥¼ ì´ìš©í•œë‹¤.
    - DriverManagerë¥¼ í†µí•´ Connectionì„ ë§Œë“  ë’¤, Connectionì„ í†µí•´ Statementë¥¼ ë§Œë“ ë‹¤. ì´í›„ Statementë¥¼ í†µí•´ dbì™€ì •ë³´ë¥¼ ì£¼ê³  ë°›ëŠ”ë‹¤.
    - ë¹„ìœ í•˜ìë©´, Connectionì€ ë„ë¡œ, StatementëŠ” íŠ¸ëŸ­. ì£¼ê³  ë°›ëŠ” ì •ë³´(Query)ê°€ íŠ¸ëŸ­ì˜ ìˆ˜í•˜ë¬¼.
    
- JDBCì˜ ì ˆì°¨
    
    ![Untitled](JDBC%20%E1%84%80%E1%85%AD%E1%84%8B%E1%85%B2%E1%86%A8%20574344152fda4b59b798121d66bfcc3d/Untitled%202.png)
    
    ![Untitled](JDBC%20%E1%84%80%E1%85%AD%E1%84%8B%E1%85%B2%E1%86%A8%20574344152fda4b59b798121d66bfcc3d/Untitled%203.png)
    
    ![Untitled](JDBC%20%E1%84%80%E1%85%AD%E1%84%8B%E1%85%B2%E1%86%A8%20574344152fda4b59b798121d66bfcc3d/Untitled%204.png)
    
    ![Untitled](JDBC%20%E1%84%80%E1%85%AD%E1%84%8B%E1%85%B2%E1%86%A8%20574344152fda4b59b798121d66bfcc3d/Untitled%205.png)
    
    ![Untitled](JDBC%20%E1%84%80%E1%85%AD%E1%84%8B%E1%85%B2%E1%86%A8%20574344152fda4b59b798121d66bfcc3d/Untitled%206.png)
    

# 2. JDBC ê°œìš” ë° ì—°ê²°

- DriverManager, Connectionì ˆì°¨
    - Connection ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•œë‹¤. (ì¶”í›„ try-catchë¥¼ ìœ„í•´)
    Connection con = null;
    - ì‚¬ìš©í•  ë“œë¼ì´ë²„ë¥¼ ë“±ë¡í•œë‹¤. (ì‚¬ìš©í•  DBMS ì¸ì§€)
    Class.forname(â€oracle.jdbc.driver.OracleDriverâ€);
    â†’ ëª©ì ì§€ (jdbc.driver.OracleDriver)ì„¤ì •
    - DriverManagerë¥¼ ì´ìš©í•´ Connection ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•œë‹¤. 
    â†’ ipì£¼ì†Œì™€ port ë²ˆí˜¸, ê³„ì •ì˜ ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ connectionì„ í†µí•´ ì—°ê²°í•œë‹¤.
    â†’ con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", 
                                                                    â€œC##EMPLOYEE", "EMPLOYEE");
    â†’ ì•ì„œ ìƒì„±í•œ con ì¸ìŠ¤í„´ìŠ¤ì˜ í• ë‹¹ ê³¼ì •. Drivermanagerì˜ getConnection ë‚´ì¥ ë©”ì†Œë“œë¥¼ í†µí•´ jdbc:oracleì˜ ipì£¼ì†Œ(localhost)ì™€ í¬íŠ¸ë²ˆí˜¸(1521),
    ì‚¬ìš©í•  dbmsì˜ ê³„ì • ì´ë¦„(C##EMPLOYEE)ì™€ ë¹„ë°€ë²ˆí˜¸(EMPLOYEE)ë¥¼ ì…ë ¥í•œë‹¤.
    â†’ ëª©ì ì§€ì˜ ì£¼ì†Œ(ip), í˜¸ìˆ˜(port) ì´ë¦„(username)ê³¼ ë¹„ë°€ë²ˆí˜¸(password) ì…ë ¥
    - ì´í›„, try catch êµ¬ë¬¸ê³¼ closeë¥¼ í†µí•´ ë‹«ì•„ì¤€ë‹¤.
    - ì´ êµ¬ë¬¸ì€ ì•„ë˜ì™€ ê°™ë‹¤.
        
        ```java
        Connection con = null;
        		
        		try {
        			
        			Class.forName("oracle.jdbc.driver.OracleDriver");
        			
        			con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe", 
        											  "C##EMPLOYEE", "EMPLOYEE");	
        			
        			System.out.println("con: " + con);
        		} catch (ClassNotFoundException e) {
        			e.printStackTrace();
        		} catch (SQLException e) {
        			e.printStackTrace();
        		} finally {
        			if(con != null) {
        				try {
        					con.close();
        				} catch (SQLException e) {
        				e.printStackTrace();
        			}
        		}
        	}
        ```
        
    - driver, url, user, passwordì˜ ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ë¥¼ ìƒì„± í•œë‹¤.
        
        Connectionì˜ ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ë¥¼ ìƒì„±í•œë‹¤.
        ë“œë¼ì´ë²„ ë“±ë¡(ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ë¥¼ í™œìš©í•´ì„œ)
        Connectionì˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ë¥¼ í™œìš©í•´ì„œ)
        ì´í›„ ì¶œë ¥ê³¼ try-catchë¥¼ í†µí•œ ì˜ˆì™¸ì²˜ë¦¬, closeì²˜ë¦¬.
        
        ```java
        String driver = "oracle.jdbc.driver.OracleDriver";
        		String url = "jdbc:oracle:thin:@localhost:1521:xe";
        		String user = "C##EMPLOYEE";
        		String password = "EMPLOYEE";
        		
        		Connection con = null;
        		
        		try {
        			Class.forName(driver);
        			
        			con = DriverManager.getConnection(url, user, password);
        			
        			System.out.println("con: " + con);
        		} catch (ClassNotFoundException e) {
        			e.printStackTrace();
        		} catch (SQLException e) {
        			e.printStackTrace();
        		} finally {
        			if(con != null);{
        				try {
        					con.close();
        				} catch (SQLException e) {
        					e.printStackTrace();
        				}
        			}
        		}
        ```
        
    - driver, url, user, password ì •ë³´ë¥¼ ì™¸ë¶€ íŒŒì¼ì— ë³„ë„ë¡œ ì €ì¥í•˜ê³ , í•´ë‹¹ íŒŒì¼ì„ FileReaderë¥¼ í†µí•´ ë¶ˆëŸ¬ì˜¤ëŠ” ê³¼ì •ì„ í†µí•´ì„œë„ Connectionì´ ê°€ëŠ¥í•˜ë‹¤. 
    Propertiesì˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
    Connectionì˜ ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ ìƒì„±
        
        Properties ë‚´ì¥ ë©”ì†Œë“œ load, FileReaderë¥¼ í†µí•´ ì™¸ë¶€ì— ì €ì¥ëœ driver, url, user, password í˜¸ì¶œ. 
        í˜¸ì¶œëœ driver, url, user, passwordì˜ ìŠ¤íŠ¸ë§ íƒ€ì… ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
        Connectionì˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (í˜¸ì¶œí•œ url, user, password í™œìš©í•´ì„œ)
        ì´í›„ try-catchë¥¼ í†µí•´ ì˜ˆì™¸ì²˜ë¦¬ì™€ close ì²˜ë¦¬
        
        ```java
        package com.greedy.section01.connection;
        
        import java.io.FileNotFoundException;
        import java.io.FileReader;
        import java.io.IOException;
        import java.sql.Connection;
        import java.sql.DriverManager;
        import java.sql.SQLException;
        import java.util.Properties;
        
        public class Application3 {
        	public static void main(String[] args) {
        
        		Properties prop = new Properties();
        		
        		Connection con = null;
        		
        		try {
        			prop.load(new FileReader("src/com/greedy/section01/connection/jdbc-config.properties"));
        			
        			System.out.println(prop);
        			
        			String driver = prop.getProperty("driver");
        			String url = prop.getProperty("url");
        			String user = prop.getProperty("user");
        			String password = prop.getProperty("password");
        			
        			Class.forName(driver);
        			
        			con = DriverManager.getConnection(url, user, password);
        			
        			System.out.println("con: " + con);
        			
        		} catch(FileNotFoundException e) {
        			e.printStackTrace();
        		} catch (IOException e) {
        			e.printStackTrace();
        		} catch (ClassNotFoundException e) {
        			e.printStackTrace();
        		} catch (SQLException e) {
        			e.printStackTrace();
        		} finally{
        			if(con != null) {
        				try {
        					con.close();
        				} catch (SQLException e) {
        					e.printStackTrace();
        				}
        			}
        		}
        	}
        }
        ```
        
    - ì•ì„œ ë§Œë“¤ì—ˆë˜ ê³¼ì •ë“¤ì„ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ì˜ ë©”ì†Œë“œ ì•ˆì— ë‹´ì€ ë’¤, í•´ë‹¹ í´ë˜ìŠ¤ì˜ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹ìœ¼ë¡œ ê°ì²´ í˜¸ì¶œ, closeë“±ì„ í¸ë¦¬í•˜ê²Œ í•  ìˆ˜ ìˆë‹¤.
    ë‹¨, ì´ ë•Œ RETURNê°’ì— null ê°’ì´ ì•„ë‹Œ ì¸ìŠ¤í„´ìŠ¤ëª…ì„ ë„£ì–´ì¤˜ì•¼ í•œë‹¤. (ì•ˆ ê·¸ëŸ¬ë©´ null-point-exception ë°œìƒ)
        
        ìš°ì„  Connectionì˜ ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ì™€ Propertiesì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„± í•œ ë’¤,
        Propertiesë¥¼ ì´ìš©, ì™¸ë¶€ íŒŒì¼ì— ìˆëŠ” driver, url, user, password í˜¸ì¶œ
        ì´í›„ driver, url String ìë£Œí˜• ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
        
        ë“œë¼ì´ë²„ ë“±ë¡
        
        try- catch í›„ (closeëŠ” í•˜ì§€ ì•ŠëŠ”ë‹¤!)
         return ê°’ìœ¼ë¡œ Connection ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ ì…ë ¥
        
        ```java
        public static Connection getconnection() {
        
        		Connection con = null;
        		
        		Properties prop = new Properties();
        		
        		try {
        			prop.load(new FileReader("config/connection-info.properties"));
        			
        			System.out.println(prop);
        			String driver = prop.getProperty("driver");
        			String url = prop.getProperty("url");
        			
        			Class.forName(driver);
        			
        			con = DriverManager.getConnection(url, prop);
        			
        			System.out.println("getConnectionì˜ con: " + con);
        		} catch (IOException e) {
        			e.printStackTrace();
        		} catch (ClassNotFoundException e) {
        			e.printStackTrace();
        		} catch (SQLException e) {
        			e.printStackTrace();
        		} 
        		
        		return con;
        	}
        
        public static void close(Connection con) {
        		try {
        			if(con != null && !con.isClosed()) {		
        				con.close();
        			}
        		} catch (SQLException e) {
        			e.printStackTrace();
        		}
        	}
        ```
        
    - close ì—­ì‹œ ë©”ì†Œë“œë¥¼ ë§Œë“  ë’¤ í˜¸ì¶œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- Connection, Statement, ResultSet
    - Connectionì„ í†µí•´ ì—°ê²°í•  DB ë°ì´í„°ë¥¼ ì„¤ì •í•œ ë’¤, 
    Statementë¥¼ í†µí•´ ì¿¼ë¦¬ë¬¸ì„ ì €ì¥í•˜ê³  ì‹¤í–‰í•˜ëŠ” ê¸°ëŠ¥ì„ ë§Œë“ ë‹¤.
    ResultSetì„ í†µí•´ Select ì¿¼ë¦¬ ì‹¤í–‰ í›„ ëŒì•„ì˜¤ëŠ” ê²°ê³¼ ì§‘í•©(Result Set)ì„ ë°›ì•„ ì¤€ë‹¤.
        
        ```java
        package com.greedy.section01.statement;
        
        import static com.greedy.common.JDBCTemplate.getConnection;
        import static com.greedy.common.JDBCTemplate.close;
        import java.sql.Connection;
        import java.sql.ResultSet;
        import java.sql.SQLException;
        import java.sql.Statement;
        
        public class Application1 {
        
        	public static void main(String[] args) {
        
        		Connection con = getConnection();
        		
        		Statement stmt = null;
        		
        		ResultSet rset = null;
        		
        		
        		try {
        			
        			stmt = con.createStatement();
        			
        			rset = stmt.executeQuery("SELECT A.EMP_ID, A.EMP_NAME ì‚¬ì›ëª… FROM EMPLOYEE A WHERE EMP_ID = '201'");
        			
        			while(rset.next()) {
        				System.out.println(rset.getString("EMP_ID") + ", " + rset.getString("ì‚¬ì›ëª…"));		
        			}
        		} catch (SQLException e1) {
        			e1.printStackTrace();
        		} finally {
        			close(rset);
        			close(stmt);
        			close(con);
        		}				
        	}
        }
        ```
        
    - íë¦„ì€ ìœ„ì™€ ê°™ë‹¤. ìš°ì„  Connectionì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì™¸ë¶€ classì˜ getConnection methodë¥¼ í†µí•´ ìƒì„±í•œë‹¤.
    - ì´í›„ Statment, ResultSetì˜ ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•œë‹¤.
    - ì´í›„ Connection ì¸ìŠ¤í„´ìŠ¤ë¡œ Statmentì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.
    - ì´í›„ executeQuery() methodë¡œ ì¿¼ë¦¬ë¬¸ì„ ì‹¤í–‰í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ResultSetì— ë°˜í™˜í•œë‹¤.
    - ì´í›„, whileë¬¸ì„ í™œìš©, rset.next()ë¥¼ í†µí•´ ê²°ê³¼ê°’ìœ¼ë¡œ ë°›ì€ ì¿¼ë¦¬ë¬¸ì„ printlnê³¼ ê²°í•©, í•˜ë‚˜í•˜ë‚˜ ì¶œë ¥í•œë‹¤.   (Iterator ë•Œ ì‚¬ìš©í–ˆë˜ ë°©ì‹)
    - ì´í›„ ì˜ˆì™¸ì²˜ë¦¬ì™€ ì™¸ë¶€ method closeë¥¼ í˜¸ì¶œí•˜ì—¬ ë‹«ì•„ì£¼ë©´ ë.
- PreparedStatementì™€ Connectionê³¼ì˜ ì°¨ì´ì 
    - PreparedStatementëŠ” ì¤€ë¹„ëœ Connectionìœ¼ë¡œ ìƒê°í•  ìˆ˜ ìˆë‹¤. ê°’ ë¶€ë¶„ì— ?(Placeholder)ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, í•´ë‹¹ ê¸°ëŠ¥ì„ í†µí•´ sqlinjectionì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤. 
    â†’ â€˜â€™ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ê²Œ ë§‰ì•„ë‘ ìœ¼ë¡œì„œ, orì„ ì´ìš©í•œ í•´í‚¹ ì‹œë„ë¥¼ ë°©ì§€í•˜ëŠ” ê²ƒ.
        
        ```java
        String query = "SELECT A.* FROM EMPLOYEE A WHERE EMP_ID = '" + empId + "'";
        -- Connecion ì˜ ê²½ìš°
        
        String query = "SELECT EMP_ID, EMP_NAME, SALARY FROM EMPLOYEE WHERE EMP_ID = ?";
        -- PreparedStatement ì˜ ê²½ìš°
        
        String query = "SELECT * FROM EMPLOYEE WHERE EMP_NAME LIKE '%' || ? || '%'";
        -- PreparedStatementì˜ ''ëŠ” ìœ„ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.
        ```
        
    - ê·¸ ì™¸ì—ëŠ” í° ì°¨ì´ì ì€ ì—†ë‹¤. ì„ ì–¸ ì‹œ  Statementê°€ ì•„ë‹Œ PreparedStatementë¥¼ ì‚¬ìš©í•˜ëŠ” ì •ë„.
- sqlinjection
    - í•´í‚¹ ë°©ë²•ìœ¼ë¡œ, 10ëŒ€ ë³´ì•ˆ ìœ„í˜‘ì— ì†í•œë‹¤.
    - íŠ¹ì • ì •ë³´ë¥¼ ì…ë ¥ë°›ì•„ ì²˜ë¦¬í•  ë•Œ, Connectionì„ ì‚¬ìš© ì‹œ ê°€ì§€ëŠ” êµ¬ì¡°ì ì¸ ì•½ì ì„ ì´ìš©,  í•„ë“œë³€ìˆ˜ë¥¼
        
        ```java
        private static String empName = "' OR 1=1 AND EMP_ID = '203";
        ```
        
    - ìœ„ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ í•­ìƒ trueê°€ ë‚˜ì˜¤ê²Œ ì„¤ì •í•¨ìœ¼ë¡œì„œ ë¡œê·¸ì¸ê°™ì€ ìƒí™©ì—ì„œ ë‘ ê°œì˜ ê°’ ì¤‘ í•˜ë‚˜ë§Œ ì•Œì•„ë„ ë°©ë¹„ë¥¼ ë¬´ë ¥í™”ì‹œí‚¬ ìˆ˜ ìˆë‹¤.
    - ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•œ ë°©ë²•ì€ ê°„ë‹¨í•œë°, PreparedStatementë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
- log íŒŒì¼ ì¶”ê°€
    - java_Project í´ë”ì— propertiesë¥¼ í†µí•´ Sourceíƒ­ìœ¼ë¡œ ì§„ì…. ë¡œê·¸ íŒŒì¼ì„ ì €ì¥í•´ë‘” í´ë”ë¥¼ add Folderë¥¼ í†µí•´ ì¶”ê°€í•˜ì—¬ ì ìš©í•œë‹¤. ì´í›„ Libì— ì¶”ê°€í•œ log4jdbcë¥¼ configì˜ ê³„ì • ì—°ê²° ìš© propertiesì—(connection-info.properties) ì¶”ê°€í•˜ì—¬ log ë“±ë¡ì„ í•  ìˆ˜ ìˆë‹¤.

# 3. CRUD

- Insert
    - ResultSetì´ ì•„ë‹Œ,  int result = 0; ì„ í†µí•´ ê²°ê³¼ê°’ì„ insertê°€ ëë‹¤ëŠ” 1, ì•ˆ ëë‹¤ëŠ” 0ìœ¼ë¡œ ë°›ëŠ”ë‹¤.
    - ê²°ê³¼ êµ¬ë¬¸ì€ 
    result = pstmt.executeUpdate();
    ë¡œ, executeQueryê°€ ì•„ë‹Œ executeUpdate()ë¡œ ì§„í–‰í•˜ë©°, í•´ë‹¹ ê²°ê³¼ëŠ” 1ê³¼ 0ìœ¼ë¡œ (intí˜•) ë°˜í™˜ëœë‹¤.
    - javaì—ì„œ DML ì‘ì—…ì„ í•  ë•Œ, close ë‹¨ê³„ì—ì„œ commitì´ ì§„í–‰ëœë‹¤.
        
        ```java
        package com.greedy.section01.insert;
        
        import static com.greedy.common.JDBCTemplate.getConnection;
        import static com.greedy.common.JDBCTemplate.close;
        
        import java.io.FileInputStream;
        import java.io.IOException;
        import java.sql.Connection;
        import java.sql.PreparedStatement;
        import java.sql.SQLException;
        import java.util.Properties;
        
        public class Application1 {
        
        	public static void main(String[] args) {
        		Connection con = getConnection();
        		
        		PreparedStatement pstmt = null;
        		int result = 0;			// DMLì„ ì§„í–‰í•˜ë©´ ê²°ê³¼ê°€ ResultSetì´ ì•„ë‹Œ intê°€ ë°˜í™˜ëœë‹¤.
        		
        		Properties prop = new Properties();
        		
        		try {
        			prop.loadFromXML(new FileInputStream("mapper/menu-query.xml"));
        			String query = prop.getProperty("insertMenu");
        			
        			System.out.println("menu insert ì¿¼ë¦¬: " + query);
        			
        			pstmt = con.prepareStatement(query);
        			pstmt.setString(1, "ì´ˆì½”ë¦¿ìƒ¤ë¸Œìƒ¤ë¸Œ");
        			pstmt.setInt(2, 10000000);
        			pstmt.setInt(3, 7);
        			pstmt.setString(4, "Y");
        			
        			result = pstmt.executeUpdate();			// DML ì¿¼ë¦¬ë¥¼ ìˆ˜í–‰í•  ë•ŒëŠ” executeUpdate()ì´ë©° ê²°ê³¼ëŠ” int(DML ì‘ì—…ì´ ì´ë£¨ì–´ì§„ í–‰ì˜ ê°¯ìˆ˜)ë‹¤.
        			
        			
        		} catch (IOException e) {
        			e.printStackTrace();
        		} catch (SQLException e) {
        			e.printStackTrace();
        		} finally {
        			close(pstmt);
        			close(con);								// íŠ¸ëœì­ì…˜ì¸ commitì´ ë°œìƒí•¨.
        		}
        		
        		System.out.println("result : " + result);
        	}
        
        }
        ```
        
    - Propertiesë¥¼ í†µí•´ XMLë¬¸ì„œì˜ SQLë¬¸ì„ ì¿¼ë¦¬ë¡œ ì§€ì •í•œë‹¤.
    - ì´í›„ PreparedStatementì˜ ê°’ìœ¼ë¡œ connectionì„ í†µí•´ ì•ì„œ ì§€ì •í•œ queryê°’ì„ ì§€ì •í•œë‹¤.
    - ì´í›„ preparedStatementì˜ ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ê° placeholderì— ê°’ë“¤ì„ setì„ í†µí•´ ì§€ì •í•œë‹¤.
    - ì´í›„ executeUpdateë¥¼ í†µí•´ Insert ì‘ì—…ì´ ì´ë£¨ì–´ì¡ŒëŠ”ì§€ ì—¬ë¶€ë¥¼ 0ê³¼ 1ë¡œ ë°˜í™˜í•˜ëŠ” result ë³€ìˆ˜ ê°’ì„ ì§€ì •í•œë‹¤.
- Update
    - ì „ì²´ì ì¸ íë¦„ì€ Insertì™€ ìœ ì‚¬í•˜ë‹¤. DTO í´ë˜ìŠ¤ì— ì»¬ëŸ¼ë“¤ì„ ìë£Œí˜•ì— ë§ì¶° ë³€ìˆ˜í™” í•´ ë‘ê³ , setì„ í†µí•´ XMLíŒŒì¼ì— ì§€ì •í•´ ë‘” SQLë¬¸ì˜ Placeholderì— ê°’ì„ ë„£ëŠ”ë‹¤. ì´í›„ í•´ë‹¹ ê°’ì„ ë‹¤ì‹œ getì„ í†µí•´ êº¼ë‚´ì˜¨ ë’¤ PreparedStatementì˜ ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ì— ê°’ì„ ì§€ì •í•˜ëŠ” ê²ƒ.
        
        ```java
        package com.greedy.section02.update;
        
        import static com.greedy.common.JDBCTemplate.getConnection;
        import static com.greedy.common.JDBCTemplate.close;
        
        import java.io.FileInputStream;
        import java.io.IOException;
        import java.sql.Connection;
        import java.sql.PreparedStatement;
        import java.sql.SQLException;
        import java.util.Properties;
        import java.util.Scanner;
        
        import com.greedy.model.dto.MenuDTO;
        
        public class Application1 {
        
        	public static void main(String[] args) {
        		Scanner sc = new Scanner(System.in);
        		System.out.print("ë³€ê²½ í•  ë©”ë‰´ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”: ");
        		int menuCode = sc.nextInt();
        		System.out.print("ë³€ê²½ í•  ë©”ë‰´ì˜ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”: ");
        		sc.nextLine();
        		String menuName = sc.nextLine();
        		System.out.print("ë³€ê²½ í•  ë©”ë‰´ì˜ ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš”: ");
        		int menuPrice = sc.nextInt();
        		System.out.print("ë³€ê²½ í•  ë©”ë‰´ì˜ ì¹´í…Œê³ ë¦¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”(4~12)");
        		int categoryCode = sc.nextInt();
        		System.out.print("ë©”ë‰´ íŒë§¤ ì—¬ë¶€ë¥¼ ì…ë ¥í•˜ì„¸ìš”(Y/N): ");
        		sc.nextLine();
        		String orderableStatus = sc.nextLine().toUpperCase();
        		
        		MenuDTO changedMenu = new MenuDTO();
        		changedMenu.setCode(menuCode);
        		changedMenu.setPrice(menuPrice);
        		changedMenu.setName(menuName);
        		changedMenu.setCategoryCode(categoryCode);
        		changedMenu.setOrderableStatus(orderableStatus);
        
        		/* -------------------------------------------------------------- */
        
        		Connection con = getConnection();
        		PreparedStatement pstmt =null;
        		int result = 0;
        		
        		Properties prop = new Properties();
        		
        		try {
        			prop.loadFromXML(new FileInputStream("mapper/menu-query.xml"));
        			String query = prop.getProperty("updateMenu");
        			
        //			System.out.println("updateì„ ìœ„í•´ ê°€ì ¸ì˜¨ ì¿¼ë¦¬: " + query);
        			
        			pstmt = con.prepareStatement(query);
        			pstmt.setString(1, changedMenu.getName());
        			pstmt.setInt(2, changedMenu.getPrice());
        			pstmt.setInt(3, changedMenu.getCategoryCode());
        			pstmt.setString(4, changedMenu.getOrderableStatus());
        			pstmt.setInt(5, changedMenu.getCode());
        			
        			result = pstmt.executeUpdate();
        			
        		} catch (IOException e) {
        			e.printStackTrace();
        		} catch (SQLException e) {
        			e.printStackTrace();
        		} finally {
        			close(pstmt);
        			close(con);
        		}
        		
        		if(result > 0) {
        			System.out.println("ë©”ë‰´ ìˆ˜ì • ì„±ê³µ!");
        		} else {
        			System.out.println("ë©”ë‰´ ìˆ˜ì • ì‹¤íŒ¨!");
        		}
        	}
        
        }
        ```
        
    - Scannerë¥¼ í†µí•´ ìœ ì €ê°€ ì…ë ¥í•œ ê°’ì„ ë³€ìˆ˜ì§€ì •í•œ ë’¤, í•´ë‹¹ ë³€ìˆ˜ë¥¼ DTOí´ë˜ìŠ¤ì˜ set ê°’ìœ¼ë¡œ ì§€ì •í•œë‹¤.
    - ì´í›„ Propertiesë¥¼ í†µí•´ XML ë¬¸ì„œì˜ SQLë¬¸ì„ ë¶ˆëŸ¬ì˜¨ë‹¤.
    - ì´í›„ ìœ ì €ê°€ ì…ë ¥í•œ ê°’ì„ getì„ í†µí•´ DTO í´ë˜ìŠ¤ì—ì„œ ê°€ì ¸ì˜¨ ë’¤, í•´ë‹¹ ê°’ì„ XML ë¬¸ì„œì˜ SQLë¬¸ì„œì˜ set ê°’ìœ¼ë¡œ ì§€ì •í•œë‹¤. (PreparedStatementë¥¼ í†µí•´)
    - ì´í›„ executeUpdateë¥¼ í†µí•´ ì—…ë°ì´íŠ¸ê°€ ë°˜ì˜ë˜ì—ˆëŠ”ì§€ ë°˜í™˜ê°’ì„ 0ê³¼ 1ë¡œ í™•ì¸í•œë‹¤.
    - ì´í›„ ifë¬¸ì„ í†µí•´ 0ê³¼ 1ì˜ ê²°ê³¼ë¬¸ì„ ì¶œë ¥í•œë‹¤.
- Delete
    - ì—­ì‹œ íë¦„ì€ ë™ì¼í•˜ë‹¤.
        
        ```java
        package com.greedy.section03.delete;
        
        import static com.greedy.common.JDBCTemplate.getConnection;
        import static com.greedy.common.JDBCTemplate.close;
        
        import java.io.FileInputStream;
        import java.io.IOException;
        import java.sql.Connection;
        import java.sql.PreparedStatement;
        import java.sql.SQLException;
        import java.util.Properties;
        import java.util.Scanner;
        
        public class Application1 {
        	public static void main(String[] args) {
        		Scanner sc = new Scanner(System.in);
        		System.out.println("ì‚­ì œ í•  ë©”ë‰´ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”: ");
        		int menuCode = sc.nextInt();
        		
        		/* ------------------------------------------------------ */
        		
        		Connection con = getConnection();
        		PreparedStatement pstmt = null;
        		int result = 0;
        		
        		Properties prop = new Properties();
        		
        		try {
        			prop.loadFromXML(new FileInputStream("mapper/menu-query.xml"));
        			String query = prop.getProperty("deleteMenu");
        			
        //			System.out.println("ë©”ë‰´ deleteìš© ì¿¼ë¦¬: " + query);
        			
        			pstmt = con.prepareStatement(query);
        			pstmt.setInt(1, menuCode);
        			
        			result = pstmt.executeUpdate();
        			
        		} catch (IOException e) {
        			e.printStackTrace();
        		} catch (SQLException e) {
        			e.printStackTrace();
        		} finally {
        			close(pstmt);
        			close(con);
        		}
        	
        		if(result > 0) {
        			System.out.println("ë©”ë‰´ ì‚­ì œ ì„±ê³µ!");
        		} else {
        			System.out.println("ë©”ë‰´ ì‚­ì œ ì‹¤íŒ¨!");
        		}
        		
        		
        	}
        
        }
        ```
        
    - ìœ„ êµ¬ë¬¸ì—ì„œì˜ deleteëŠ” pkë²ˆí˜¸ í•˜ë‚˜ë¡œ delete êµ¬ë¬¸ì„ ì‹¤í–‰í•˜ê¸°ì— DTO í´ë˜ìŠ¤ëŠ” ìƒëµí•œë‹¤.
    - Scanner apië¥¼ í†µí•´ ìœ ì € ì…ë ¥ ë²ˆí˜¸ë¥¼ int ë³€ìˆ˜ë¡œ ì§€ì •í•œ ë’¤
    - Propertiesë¥¼ í†µí•´ XML ë¬¸ì„œì˜ delete sqlë¬¸ query ê°’ìœ¼ë¡œ ë¶ˆëŸ¬ì˜¨ë‹¤.
    - ì´í›„ Preparestatement ë¥¼ í†µí•´ query ê°’ì„ ë°›ëŠ”ë‹¤.
    - ì´í›„ executeUpdateë¥¼ í†µí•´ ë°˜í™˜ê°’ì„ result ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤.
    - ì´í›„ 0ê³¼ 1ë¡œ ifë¬¸ì„ ì‹œí–‰í•´ ê²°ê³¼ ì¶œë ¥.

# 4. ê³„ì¸µê³¼ ê³„ì¸µ ë¶„í• 

- ê³„ì¸µêµ¬ì¡° (MVC MODEL2)
    
    ![KakaoTalk_20220408_181121995.png](JDBC%20%E1%84%80%E1%85%AD%E1%84%8B%E1%85%B2%E1%86%A8%20574344152fda4b59b798121d66bfcc3d/KakaoTalk_20220408_181121995.png)
    
    - ì •ì˜ì™€ ê°œìš”
        - Model(Service, dao, dto) View Controller
        
        ![Untitled](JDBC%20%E1%84%80%E1%85%AD%E1%84%8B%E1%85%B2%E1%86%A8%20574344152fda4b59b798121d66bfcc3d/Untitled%207.png)
        
        - View: ì¶œë ¥. í™”ë©´ì— ë³´ì—¬ì§€ëŠ” ë‹¨ê³„ (í”„ë¡ íŠ¸)
        - Controller: ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì •ë³´ë¥¼ í•˜ë‚˜ë¡œ ë¬¶ì–´(DTO, MAP) ë‘ëŠ” ë‹¨ê³„
        - Service: Connection: Controllerì—ì„œ ë°›ì€ ì •ë³´ë¥¼ ê°ì²´ë¥¼ ìƒì„±/ë°˜ë‚© í•˜ë©°, íŠ¸ëœì­ì…˜ì„ ì œì–´í•˜ëŠ” ë‹¨ê³„
        - DAO: Statement, PrepareStatementë¥¼ í†µí•´ queryë¥¼ ìƒì„±/ë°˜ë‚© í•˜ëŠ” ë‹¨ê³„
        - DB: DataBase. ì •ë³´ ì²˜ë¦¬ ë‹¨ê³„.
        - â†’ MVC MODEL1ì—ì„œëŠ” view, Controller, serviceë¥¼ í•˜ë‚˜ì˜ ë‹¨ê³„ë¡œ ë¬¶ëŠ” êµ¬ì¡°.
        - MVC ì—­ì‹œ í•˜ë‚˜ì˜ ë””ìì¸ íŒ¨í„´ì´ë‹¤.
    - 5 ê³„ì¸µ
        - View
            - ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì§€ëŠ” (í™”ë©´ë‹¨) ë¶€ë¶„ì˜ ì½”ë“œ
            - íƒ€ ê³„ì¸µ(Service)ìœ¼ë¡œë¶€í„° ë°›ì•„ì˜¨ ì •ë³´ë¥¼ ì¶œë ¥í•˜ê³ , í™”ë©´ë‹¨ì— ë³´ì—¬ì§ˆ ë¬¸ì¥ ë“±ì„ Print methodë¥¼ í†µí•´ ì¶œë ¥í•˜ëŠ” ë“±ì˜ ì—­í• ì„ í•œë‹¤.
            - í•„ë“œ ì˜ì—­ì— Controller ìƒì„±ìë¥¼ ë§Œë“¤ê³  ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•œë‹¤.
            - íŠ¸ëœì­ì…˜ì— ë”°ë¥¸ Service ì˜ì—­ì˜ ìµœì¢… ê²°ê³¼ê°’ì— ë”°ë¥¸ í™”ë©´ë‹¨ ì˜ì—­.
            - ë‹¤ë§Œ, Controllerì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ì—†ëŠ” ê°€ê³µì²˜ë¦¬(ë°˜ë³µìœ¼ë¡œ ì¸í•œ ëˆ„ì ê°’ì´ í•„ìš”í•œ ê²½ìš°) ëŠ” View ì˜ì—­ì—ì„œ ì²˜ë¦¬í•œë‹¤.
            - ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì •ë³´ë¥¼ DTOì™€ MAPì— ë‹´ì•„ Controllerë¡œ ì „ë‹¬í•œë‹¤.
        - Controller
            - ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì •ë³´ë¥¼ íŒŒë¼ë¯¸í„° í˜•íƒœ(DTO, MAP)ë¡œ ì „ë‹¬ë°›ì€ ë’¤, ì „ë‹¬ë°›ì€ ê°’ì„ ê²€ì¦í•œë‹¤.
            - ì •ë³´ì˜ ê°€ê³µì€ ë³¸ë˜ Serviceì˜ì—­ì—ì„œ ë§¡ëŠ” ì¼ì´ì—ˆìœ¼ë‚˜, Controller ì˜ì—­ì—ì„œ ë§¡ëŠ” ê²ƒì´ ì¶”ì„¸.
            - Serviceì˜ ìƒì„±ìë¥¼ ë§Œë“¤ê³  ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•œë‹¤.
            - ìˆ˜í–‰ ê²°ê³¼ë¥¼ ë°˜í™˜ ë°›ì•„ ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì¤„ ë·°ë¥¼ ê²°ì •í•œë‹¤.
            â†’ ë¡œê·¸ì¸ ì‹œ ì„±ê³µí™”ë©´ê³¼ ì‹¤íŒ¨ í™”ë©´ê³¼ ê°™ì€ í˜•ì‹
            - ë·°ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ì „ë‹¬í•œë‹¤.
        - Service (Transaction)
            - DBì˜ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê¸° ìœ„í•´ ì—°ê²°(Connection)ì„ ë‹´ë‹¹í•˜ëŠ” ê³„ì¸µ.
            - Connection ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ë°˜í™˜(close)í•œë‹¤. ë§¤ê°œë³€ìˆ˜ë¡œ Connectionì¸ìŠ¤í„´ìŠ¤ì˜ ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ë¥¼ ë˜ì§„ë‹¤.
            - DAO ìƒì„±ìë¥¼ í•„ë“œ ì˜ì—­ì—ì„œ ìƒì„±í•œë‹¤.
            - Connectionê³¼ Controllerì—ì„œ ë°›ì€ ê°ì²´ë¥¼ ìƒì„±/ë°˜ë‚© í•˜ë©°, íŠ¸ëœì­ì…˜ì„ ì œì–´í•œë‹¤.
            - ìµœì¢… ê²°ê³¼ ê°’ì„ ë°˜í™˜í•œë‹¤. (íŠ¸ëœì­ì…˜ì˜ ê²°ê³¼ê°’(commit, rollback))
                - íŠ¸ëœì­ì…˜(Transaction)
                    - ë‹¤ë¥¸ ë§ë¡œ ë…¼ë¦¬ì  ì‘ì—… ë‹¨ìœ„(logical unit of work)ë¼ê³ ë„ í•œë‹¤.
                    - Connectionì˜ ë‚´ì¥ ë©”ì†Œë“œì¸ setAutoCommitì€ ê¸°ë³¸ ê°’ trueë¡œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©°, finallyë¥¼ í†µí•´ Connectionì„ closeí–ˆì„ ë•Œ commit ì‘ì—…ì´ ë‚´ë¶€ì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.
                    - ì´ ë•Œ ì‘ì—…ì€ í•˜ë‚˜ì˜ ë…¼ë¦¬ì  ì‘ì—… ë‹¨ìœ„(íŠ¸ëœì­ì…˜)ë¡œ ì´ë£¨ì–´ì§€ë©°, ê°ê°ì˜ ì‘ì—…ë§ˆë‹¤ commitì´ ìë™ìœ¼ë¡œ ì´ë£¨ì–´ì§„ë‹¤. (ë”°ë¼ì„œ, autoCommitì´ trueì¼ ë•Œ, ë‘ ê°œì˜ dmlì‘ì—… ì¤‘ í•˜ë‚˜ê°€ falseì—¬ë„ trueì¸ ì‘ì—…ì€ ìë™ìœ¼ë¡œ commit, dbì— ì ìš©ëœë‹¤. )
                    - ì´ì™€ ê°™ì€ ë°©ì‹ì€ ì—¬ëŸ¬ ê°œì˜ DMLì‘ì—…ì´ ìœ ê¸°ì ìœ¼ë¡œ ì—°ê²°ë˜ì–´ ìˆì„ ë•Œ ë¬¸ì œê°€ ë°œìƒë  ì—¬ì§€ê°€ ìˆë‹¤. ë”°ë¼ì„œ setAutoCommitì˜ ê°’ì„ fasleë¡œ ì„¤ì •í•œ ë’¤, ifë¬¸ì„ í†µí•´ íŠ¸ëœì­ì…˜ ë‹¨ìœ„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ  commitì´ ì´ë£¨ì–´ì§€ê²Œ ë³€ê²½, í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì´ ëª¨ë‘ trueì¼ ë•Œ commitì´ ì´ë£¨ì–´ì§€ë„ë¡ ë³€ê²½í•  í•„ìš”ê°€ ìˆë‹¤.
                    - ìœ ê¸°ì ì¸ ì—°ê²°ì€ Triggerë¥¼ ìƒê°í•˜ì. JDBCì˜ autoCommitì´ trueë¼ë©´, triggerì˜ ì „ì œì¡°ê±´(Before)ì´ falseì„ì—ë„ triggerê°€ ì‹¤í–‰ë  ìˆ˜ ìˆë‹¤.
            - ! Connectionì€ ë°˜ë“œì‹œ ì§€ì—­ë³€ìˆ˜ë¡œ ì„ ì–¸í•´ì•¼ í•œë‹¤.
        - DAO(Data Access Objects**)**
            - ë°ì´í„°ë² ì´ìŠ¤ì— ê´€ë ¨ëœ CRUD ì‘ì—…ì„ ì „ë¬¸ì ìœ¼ë¡œ ë‹´ë‹¹ í•˜ëŠ” ê°ì²´.
            - ë‹¨ì¼ì±…ì„ì˜ ì›ì¹™ì„ ìœ„í•´ DBì— ì ‘ê·¼í•˜ëŠ” ê°ì²´ë“¤ì„ ë”°ë¡œ ë¶„ë¥˜í•˜ëŠ” ë””ìì¸ íŒ¨í„´ì´ë¼ê³  ìƒê°í•˜ì.
            - ë³„ë„ì˜ class ì•ˆì— ë…ë¦½ëœ methodë“¤ë¡œ Statementì™€ PrepareStatementë¥¼ ì´ìš© í•´  DBë¡œë¶€í„° ë°›ì•„ì˜¨ ê²°ê³¼ ì§‘í•©(ResultSet, Result)ì„ ë°˜í™˜ê°’ìœ¼ë¡œ ë¦¬í„´í•œë‹¤.
        - DB
            - Data Base. Oracle ë“±ì˜ í”„ë¡œê·¸ë¨ì„ í†µí•´ ë°ì´í„°ë¥¼ ì €ì¥í•´ë‘ëŠ” ê³„ì¸µ.
            - JDBCëŠ” Driverë¥¼ í†µí•´ DBë¡œë¶€í„° ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
- ê³„ì¸µ ë¶„í• ê³¼ ì™¸ë¶€ íŒŒì¼
    - DTO
        - Data Transfer Object
        - DBì˜ ë°ì´í„° ë‹¨ìœ„(ë³´í†µ ì»¬ëŸ¼ ë‹¨ìœ„)ë¥¼ private ë¡œ ìº¡ìŠí™” í•˜ì—¬ ê°ì²´í™” í•˜ëŠ” ê³„ì¸µ ë¶„í•  ë‹¨ìœ„.
        - ê³„ì¸µ ê°„ ë°ì´í„° êµí™˜ì„ ìœ„í•œ ëª©ì ìœ¼ë¡œ ìƒì„±í•œë‹¤.
        - JDBCì—ì„œ DTOë¥¼ ì´ìš©í•œ ì •ë³´ êµí™˜ì˜ ë°©ì‹
            - JDBCì—ì„œë„ DTOë¥¼ ì´ìš©, set/getì„ í†µí•´ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆë‹¤.
                
                ```java
                package com.greedy.section01.statement;
                
                import static com.greedy.common.JDBCTemplate.getConnection;
                import static com.greedy.common.JDBCTemplate.close;
                
                import java.sql.Connection;
                import java.sql.ResultSet;
                import java.sql.SQLException;
                import java.sql.Statement;
                import java.util.Scanner;
                
                import com.greedy.model.dto.EmployeeDTO;
                
                public class Application4 {
                	public static void main(String[] args) {
                
                		Connection con = getConnection();
                		Statement stmt = null;
                		ResultSet rset = null;
                		
                		EmployeeDTO selectedEmp = null;
                		
                		Scanner sc = new Scanner(System.in);
                		System.out.println("ì¡°íšŒ í•˜ë ¤ëŠ” ì‚¬ë²ˆì„ ì…ë ¥í•´ ì£¼ì„¸ìš”ã…£ ");
                		String empId = sc.nextLine();
                		
                		String query = "SELECT A.* FROM EMPLOYEE A WHERE EMP_ID = '" + empId + "'";
                		
                		try {
                			stmt = con.createStatement();
                			rset = stmt.executeQuery(query);
                			
                			if(rset.next()) {
                //				System.out.println(rset.getString("EMP_NAME"));		// í•œ ì¤„ì˜ ì¶œë ¥ë¬¸ìœ¼ë¡œ í˜„ì¬ê¹Œì§€ ë¬¸ì œê°€ ì—†ì´ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸
                				
                				selectedEmp = new EmployeeDTO();
                				
                				selectedEmp.setEmpId(rset.getString("EMP_ID"));
                				selectedEmp.setEmpName(rset.getString("EMP_NAME"));
                				selectedEmp.setEmpNo(rset.getString("EMP_no"));
                				selectedEmp.setEmail(rset.getString("EMAIL"));
                				selectedEmp.setPhone(rset.getString("PHONE"));
                				selectedEmp.setDeptCode(rset.getString("DEPT_CODE"));
                				selectedEmp.setJobCode(rset.getString("JOB_CODE"));
                				selectedEmp.setSalLevel(rset.getString("SAL_LEVEL"));
                				selectedEmp.setSalary(rset.getInt("SALARY"));
                				selectedEmp.setBonus(rset.getDouble("BONUS"));
                				selectedEmp.setManagerId(rset.getString("MANAGER_ID"));
                				selectedEmp.setHireDate(rset.getDate("HIRE_DATE"));
                				selectedEmp.setEntDate(rset.getDate("ENT_DATE"));
                				selectedEmp.setEntYn(rset.getString("ENT_YN"));
                			}
                				
                		} catch (SQLException e) {
                			e.printStackTrace();
                		} finally {
                			close(rset);
                			close(stmt);
                			close(con);
                		}
                		
                		System.out.println("selectedEmp: "  + selectedEmp);
                	}
                
                }
                ```
                
            - Connection, Statement, ResultSetì€ ê¸°ì¡´ê³¼ ë™ì¼í•˜ë‹¤.
            - EmployeeDTO(className) selectedEmp(VariableName) = null;ì„ í†µí•´ ì´ˆê¸°í™” ì§„í–‰í•œë‹¤.
            - ì´í›„ ë°˜ë³µë¬¸ì„ í†µí•´ (ë‹¨ì¼ í–‰ì¼ ê²½ìš° ifë¬¸ ì‚¬ìš©í•´ë„ ë¬´ë°©) DTOVarName.setFiledVarName(ResultSet VarName.getString(â€COLUMN NAMEâ€)); ì˜ í˜•ì‹ìœ¼ë¡œ ê°ê°ì˜ ê°’ì„ set í•œë‹¤.
            - ì´í›„ ë³€ìˆ˜ ì´ë¦„ìœ¼ë¡œ ì¶œë ¥.
            - ì¶œë ¥í•  ì»¬ëŸ¼ì´ ì—¬ëŸ¬ ê°œì¸ ê²½ìš°, ArrayListë¥¼ ì´ìš©í•  ìˆ˜ ìˆë‹¤. ì „ì²´ì ì¸ í‹€ì€ ìœ„ì™€ í¬ê²Œ ë‹¤ë¥´ì§€ ì•Šì§€ë§Œ, ArrayListì˜ ì„ ì–¸ê³¼ ì´ˆê¸°í™” ìœ„ì¹˜ì— ì£¼ì˜í•˜ì. ì¶œë ¥ì€ ArrayListë¥¼ ì‚¬ìš©í•  ë–„ì™€ ë™ì¼í•˜ê²Œ, 4ê°€ì§€ ë°©ë²• (forë¬¸, for-eachë¬¸, iterator, toString)ì„ ì´ìš©í•  ìˆ˜ ìˆë‹¤.
                
                ```java
                public static void main(String[] args) {
                		Connection con = getConnection();
                		Statement stmt = null;
                		ResultSet rset = null;
                		
                		/* í•œ í–‰ì˜ ì •ë³´ë¥¼ ë‹´ì„ DTO */
                		EmployeeDTO row = null;
                		
                		/* ì—¬ëŸ¬ DTOë¥¼ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë¡œ ë¬¶ê¸° ìœ„í•œ List */
                		List<EmployeeDTO> empList = null;
                		
                		String query = "SELECT * FROM EMPLOYEE";
                		
                		try {
                			stmt = con.createStatement();
                			rset = stmt.executeQuery(query);
                			
                			empList = new ArrayList<>();			// ì „ì²´ í–‰(DTO ì¸ìŠ¤í„´ìŠ¤)ì„ ë‹´ì„ ì»¬ë ‰ì…˜
                			while(rset.next()) {
                				row = new EmployeeDTO();			// í•œ í–‰ì„ ë‹´ì„ DTO ì¸ìŠ¤í„´ìŠ¤
                				
                				row.setEmpId(rset.getString("EMP_ID"));
                				--------------------------------------
                				row.setEntYn(rset.getString("ENT_YN"));
                				
                				empList.add(row);					// í•œ í–‰ì„ ì»¬ë ‰ì…˜ì— ì¶”ê°€í•˜ì.
                			}
                		} catch (SQLException e) {
                			e.printStackTrace();
                		} finally {
                			close(rset);
                			close(stmt);
                			close(con);
                		}
                		
                		Iterator<EmployeeDTO> iter = empList.iterator();
                		while(iter.hasNext()) {
                			System.out.println(iter.next());
                		}
                ```
                
    - Library(lib)
        - ojdbc íŒŒì¼, log íŒŒì¼ ë“± JDBCì— í•„ìš”í•œ ì™¸ë¶€ íŒŒì¼ì„ ì§€ì •í•´ ë‘” ë’¤, Classpathë¥¼ í†µí•´ ì—°ê²°í•˜ê¸° ìœ„í•œ ê³„ì¸µ ë¶„í•  ë‹¨ìœ„.
        - ì™¸ë¶€ ì†ŒìŠ¤ì™€ ìœ ì‚¬í•˜ë‹¤.
        - Library ë‹¤ìš´ë¡œë“œ ë° ì—°ê²°
            - [https://mvnrepository.com/](https://mvnrepository.com/) ë°©ë¬¸í•˜ì—¬ ì›í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ê²€ìƒ‰ (ojbdc)
            - jaríŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ í›„
            - eclipseì—ì„œ Navigator ë©”ë‰´ë¥¼ í†µí•´ workspaceì— ìƒˆë¡œìš´ í´ë” (lib)ë¥¼ ë§Œë“ ë‹¤.
            - í•´ë‹¹ í´ë”ì— ë‹¤ìš´ë¡œë“œ ë°›ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒŒì¼ (ì••ì¶• ìƒíƒœë¡œ) ë³µì‚¬ ë¶™ì—¬ë„£ê¸°.
            - workspace í”„ë¡œì íŠ¸ í´ë”ì— properties - java Build Path - Libraries ì§„ì…
            - Classpathì— add jarsë¥¼ ëˆ„ë¥¸ ë’¤ ë³µì‚¬ ë¶™ì—¬ë„£ê¸° í•œ ì••ì¶• íŒŒì¼ (jar íŒŒì¼) ì„ íƒ.
            - Classpathì— í•´ë‹¹ íŒŒì¼ í™•ì¸ë˜ê³ , Navigatorì—ì„œ í•´ë‹¹ íŒŒì¼ ì¢Œì¸¡ í•˜ë‹¨ìœ¼ë¡œ ì±… ëª¨ì–‘ ê·¸ë¦¼ ìƒì„±ë˜ë©´ Library ì„¤ì¹˜ ë° ì—°ê²° ì„±ê³µ.
    - config
        - Connectionì„ ìœ„í•œ driver, url, user, passwordì˜ ê°’ì„ ì €ì¥í•œ íŒŒì¼. ì´í›„ templateë¥¼ í†µí•´ dirver ì—°ê²°ì„ ìœ„í•œ propertiesì˜ valueê°’.
        - ê·¸ ì™¸ì—ë„ ì„¤ì • íŒŒì¼ì„ ì €ì¥í•˜ê¸° ìœ„í•œ ê³„ì¸µ ë¶„í•  ë‹¨ìœ„.
    - dbscript
        - í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•  DBì˜ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ì €ì¥í•˜ê¸° ìœ„í•œ ê³„ì¸µ ë¶„í•  ë‹¨ìœ„
    - common(Template)
        - Connection, close, commit, rollbackë“±ì˜ í•„ìˆ˜ìš”ì†Œë¥¼ ë©”ì†Œë“œ í˜•ì‹ìœ¼ë¡œ ëª¨ì•„ë‘ëŠ” ê³„ì¸µ. ì´í›„ ë©”ì†Œë“œë¥¼ ê²°ê³¼ê°’ìœ¼ë¡œ ëŒ€ì…í•˜ê±°ë‚˜(Connection), importë¥¼ í†µí•´ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ê²Œì¸µ ë¶„í• 
    - mapper
        - XML ë¬¸ì„œë¥¼ ë‹´ì•„ë‘ê¸° ìœ„í•œ ê³„ì¸µ ë¶„í• .
        - XML
            - CRUDë¥¼ ë¹„ë¡¯í•œ DB SQL ëª…ë ¹ì–´ ì¿¼ë¦¬ë¥¼ ë³„ë„ì˜ íŒŒì¼ë¡œ ì§€ì •í•˜ì—¬ ì €ì¥ í•´ ë‘ëŠ” ê³„ì¸µ ë¶„í•  ë‹¨ìœ„. Propertiesë¥¼ ì´ìš©, keyê°’ìœ¼ë¡œ ì§€ì • í•´ë‘” queryë¬¸ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.
                
                ```java
                public static void main(String[] args) {
                
                		Properties prop = new Properties();
                		prop.setProperty("keyString", "valueString");
                		
                		try {
                			prop.storeToXML(
                					new FileOutputStream("src/com/greedy/section02/preparedStatement/employee=query.xml"), "title");
                		} catch (FileNotFoundException e) {
                			e.printStackTrace();
                		} catch (IOException e) {
                			e.printStackTrace();
                		}
                	}
                ```
                
            - ìœ„ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ XML íŒŒì¼ì„ ìƒì„±í•˜ê±°ë‚˜, ì´í´ë¦½ìŠ¤ì˜ New íŒŒì¼ì„ í†µí•´ XMLíŒŒì¼ì„ ìƒì„± í•œ ë’¤ ê¸°ì¡´ì˜ ë‚´ìš©ì„ ë¶™ì—¬ë„£ëŠ” ë°©ì‹ìœ¼ë¡œ XML íŒŒì¼ì„ ë§Œë“ ë‹¤.
                
                ```java
                <?xml version="1.0" encoding="UTF-8"?>
                <!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
                <properties>
                    <comment>title</comment>
                    <!--  <entry key="keyString">valueString</entry> -->
                    
                    <!--  ë‹¨ì–´ë¡œ í•´ë‹¹ ë‹¨ì–´ë¥¼ í¬í•¨í•œ ì´ë¦„ì˜ ì‚¬ì›ì„ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ -->
                    <entry key="selectEmpByWord">
                	    SELECT
                	    	   A.*	
                	      FROM EMPLOYEE A
                	     WHERE A.EMP_NAME LIKE '%' || ? || '%' 
                    </entry>
                </properties>
                ```
                
            - <entry> </entry> ì‚¬ì´ì— ì‚¬ìš©í•  ì¿¼ë¦¬ì˜ ë‚´ìš©ì„ ì…ë ¥í•œë‹¤. ì´í›„ í•´ë‹¹ íŒŒì¼ì˜ selectEmpByWordë¥¼ keyê°’ìœ¼ë¡œ, value ê°’ì¸ ì¿¼ë¦¬ ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¤ëŠ” í˜•íƒœë¥¼ ê°€ì§„ë‹¤.
                
                ```java
                prop.loadFromXML(
                					new FileInputStream("src/com/greedy/section02/preparedStatement/employee=query.xml"));
                			
                			String query = prop.getProperty("selectEmpByWord");
                ```
                
            - ì´í›„ properties ì¸ìŠ¤í„´ìŠ¤ì˜ ë ˆí¼ëŸ°ìŠ¤ ë³€ìˆ˜ì¸ propì˜ ë‚´ì¥ ë©”ì†Œë“œì¸ loadFromXMLì„ í†µí•´ XML íŒŒì¼ì„ ë¶ˆëŸ¬ ì˜¨ ë’¤, 
            propì˜ ë‚´ì¥ ë©”ì†Œë“œ getPropertyë¥¼ ì´ìš©, keyê°’ì¸ sqlë¬¸ì˜ ì´ë¦„ì„ ë„£ìŒìœ¼ë¡œì„œ valueê°’ì¸ SQLë¬¸ ì „ì²´ë¥¼ ë¶ˆëŸ¬ì˜¨ ë’¤ queryë¡œ ì§€ì •í•œë‹¤.
            - XML ì„œì‹ ìƒì„±
                - window - preferences - xml - xmlcatalog - user specified Entries  - add - 
                Locationì— 
                chap03-crud-lecture-source/mapper/properties.dtd
                keyì— 
                http://java.sun.com/dtd/properties.dtd ë³µì‚¬ -  key type System IDë¡œ ë³€ê²½
                - ì´í›„ new - xml íŒŒì¼ì—ì„œ next í†µí•´ create file using a DTO or XML Schema file - Select XML Catalog entryì˜ KEYì—ì„œ ê¸°ì¡´ì— ìƒì„±í•œ XML í´ë˜ìŠ¤ ì§€ì •í•˜ì—¬ ìƒì„± ê°€ëŠ¥.
- MVC MODEL2 Code
    - (Main method)
        - MVC MODEL2ì—ì„œ main methodëŠ” View ì˜ì—­ì„ í˜¸ì¶œí•˜ëŠ” ê²ƒ ì™¸ì—ëŠ” ë‹¬ë¦¬ ì—­í• ì´ ì—†ë‹¤. ì´í›„ WAS ì„œë²„ì¸ í†°ìº£ì´ í•´ë‹¹ ì—­í• ì„ ë‹´ë‹¹í•˜ê²Œ ë  ê²ƒ. í˜„ì¬ë¡œì„œëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ í‚¤ê³  ë„ëŠ” ìŠ¤ìœ„ì¹˜ ì •ë„ì˜ ì—­í• .
            
            ```java
            package com.greedy.section01.run;
            
            import com.greedy.section01.view.OrderMenu;
            
            public class Application {
            
            	public static void main(String[] args) {
            
            		OrderMenu orderMenu = new OrderMenu();
            		orderMenu.displayMainMenu();
            		
            	}
            
            }
            ```
            
    - View Layer
        - ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì§€ëŠ” í™”ë©´ì„ ë‹´ë‹¹í•˜ëŠ” ì—­í• . í˜„ì¬ëŠ” Javaë¡œ ì‘ì—…í–ˆì§€ë§Œ, ì´í›„ì—ëŠ” HTMLì´ í•´ë‹¹ ì—­í• ì„ ë‹´ë‹¹í•˜ê²Œ ëœë‹¤.  Controller ê³„ì¸µì„ í˜¸ì¶œí•œë‹¤.
            
            ```java
            package com.greedy.section01.view;
            
            import java.util.ArrayList;
            import java.util.HashMap;
            import java.util.List;
            import java.util.Map;
            import java.util.Scanner;
            
            import com.greedy.section01.controller.OrderController;
            import com.greedy.section01.model.dto.CategoryDTO;
            import com.greedy.section01.model.dto.MenuDTO;
            import com.greedy.section01.model.dto.OrderMenuDTO;
            
            public class OrderMenu {
            	
            	private OrderController orderController = new OrderController();
            	
            	public void displayMainMenu() {
            		
            		List<OrderMenuDTO> orderMenuList = new ArrayList<>();
            		int totalOrderPrice = 0;
            		
            		Scanner sc = new Scanner(System.in);
            		
            		boolean flag = true;
            		do {
            			System.out.println("======== ìŒì‹ ì£¼ë¬¸ í”„ë¡œê·¸ë¨ ========");
            			
            			List<CategoryDTO> categoryList = orderController.selectAllCategory();
            			for(CategoryDTO cate : categoryList) {
            				System.out.println(cate);
            			}
            			
            			System.out.println("===============================");
            			System.out.print("ì£¼ë¬¸í•˜ì‹¤ ì¹´í…Œê³ ë¦¬ ì¢…ë¥˜ì˜ ì´ë¦„ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”ã…£");
            			String inputCategory = sc.nextLine();
            			
            			System.out.println("===========ì£¼ë¬¸ ê°€ëŠ¥ ë©”ë‰´===========");		
            			
            			List<MenuDTO> menuList = orderController.selectmenuBy(inputCategory, categoryList);
            			for(MenuDTO menu : menuList) {
            				System.out.println(menu);
            			}
            			
            			System.out.print("ì£¼ë¬¸í•˜ì‹¤ ë©”ë‰´ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”: ");
            			String inputMenu = sc.nextLine();		
            			
            			int menuCode = 0;
            			int menuPrice = 0;
            			for(int i = 0; i < menuList.size(); i++) {
            				MenuDTO menu = menuList.get(i);
            				if(menu.getName().equals(inputMenu));
            				menuCode = menu.getCode();
            				menuPrice = menu.getPrice();
            			}
            			
            			System.out.println("ì£¼ë¬¸í•˜ì‹¤ ìˆ˜ëŸ‰ì„ ì…ë ¥í•˜ì„¸ìš”: ");
            			int orderAmount = sc.nextInt();
            			
            			totalOrderPrice += menuPrice * orderAmount;
            			
            			OrderMenuDTO orderMenu = new OrderMenuDTO();
            			orderMenu.setMenuCode(menuCode);
            			orderMenu.setAmount(orderAmount);
            			
            			orderMenuList.add(orderMenu);
            			
            			sc.nextLine();
            			String isContinue = "";
            			while(true) {
            				System.out.println("ê³„ì† ì£¼ë¬¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ì˜ˆ/ì•„ë‹ˆì˜¤): ");
            				isContinue = sc.nextLine();
            				if("ì˜ˆ".equals(isContinue)) {
            					break;
            				} else if("ì•„ë‹ˆì˜¤".equals(isContinue)) {
            					flag = false;
            					break;
            				}
            			}
            			
            		} while(flag);
            	
            		Map<String, Object> requestMap = new HashMap<>();
            		requestMap.put("totalOrderPrice", totalOrderPrice);
            		requestMap.put("orderMenuList", orderMenuList);
            		
            		orderController.registOrder(requestMap);
            			
            			
            	}
            	
            
            }
            ```
            
    - Controller Layer
        - Viewë¡œë¶€í„° ì „ë‹¬ë°›ì€ ì •ë³´ë¥¼ ê²€ì¦ ë° ê°€ê³µí•œë‹¤.
            
            ```java
            package com.greedy.section01.controller;
            
            import java.text.SimpleDateFormat;
            import java.util.List;
            import java.util.Map;
            
            import com.greedy.section01.model.dto.CategoryDTO;
            import com.greedy.section01.model.dto.MenuDTO;
            import com.greedy.section01.model.dto.OrderDTO;
            import com.greedy.section01.model.dto.OrderMenuDTO;
            import com.greedy.section01.model.service.OrderService;
            import com.greedy.section01.view.ResultView;
            
            public class OrderController {
            	
            	private OrderService orderService = new OrderService();
            
            	public List<CategoryDTO> selectAllCategory() {
            		return orderService.selectAllCategory();
            	}
            
            	public List<MenuDTO> selectmenuBy(String inputCategory, List<CategoryDTO> categoryList) {
            		int categoryCode = 0;
            		for(int i = 0; i < categoryList.size(); i++) {
            			CategoryDTO category = categoryList.get(i);
            			if(category.getName().equals(inputCategory)) {
            				categoryCode = category.getCode();
            				break;
            			}
            		}
            		
            		return orderService.selectMenuBy(categoryCode);
            	}
            
            	public void registOrder(Map<String, Object> requestMap) {
            	
            		int totalorderPrice = (Integer)requestMap.get("totalOrderPrice");
            		List<OrderMenuDTO> orderMenuList = (List<OrderMenuDTO>)requestMap.get("orderMenuList");
            		
            		java.util.Date orderTime = new java.util.Date();
            		SimpleDateFormat dateFormat = new SimpleDateFormat("yy/MM/dd");
            		SimpleDateFormat timeFormat = new SimpleDateFormat("HH:mm:ss");
            		String date = dateFormat.format(orderTime);
            		String time = timeFormat.format(orderTime);		
            	
            		OrderDTO order = new OrderDTO();
            		order.setDate(date);
            		order.setTime(time);
            		order.setTotalOrderPrice(totalorderPrice);
            		order.setOrderMenuList(orderMenuList);
            		
            		int result = orderService.registOrder(order);	
            
            		ResultView resultView = new ResultView();
            		if(result >0) {
            			resultView.success(orderMenuList.size());
            		} else {
            			resultView.failed();
            		}				
            	}
            }
            ```
            
    - Service Layer
        - DBì™€ì˜ ì—°ê²°(Connection)ì„ ë‹´ë‹¹í•˜ë©°, íŠ¸ëœì­ì…˜ì„ ì œì–´í•œë‹¤.
            
            ```java
            package com.greedy.section01.model.service;
            
            import static com.greedy.common.JDBCTemplate.close;
            import static com.greedy.common.JDBCTemplate.getConnection;
            import static com.greedy.common.JDBCTemplate.commit;
            import static com.greedy.common.JDBCTemplate.rollback;
            
            import java.sql.Connection;
            import java.util.List;
            
            import com.greedy.section01.model.dao.OrderDAO;
            import com.greedy.section01.model.dto.CategoryDTO;
            import com.greedy.section01.model.dto.MenuDTO;
            import com.greedy.section01.model.dto.OrderDTO;
            import com.greedy.section01.model.dto.OrderMenuDTO;
            
            public class OrderService {
            	
            	private OrderDAO orderDAO = new OrderDAO();
            
            	public List<CategoryDTO> selectAllCategory() {
            		Connection con = getConnection();
            		
            		List<CategoryDTO> categoryList = orderDAO.selectAllCategory(con);
            		
            		close(con);
            		
            		return categoryList;
            	}
            
            	public List<MenuDTO> selectMenuBy(int categoryCode) {
            		
            		Connection con = getConnection();
            		
            		List<MenuDTO> menuList = orderDAO.selectMenuBy(con, categoryCode);
            		
            		close(con);
            		
            		return menuList;
            	}
            
            	public int registOrder(OrderDTO order) {
            		
            		Connection con = getConnection();
            		
            		int result = 0;
            		
            		int orderResult = orderDAO.registOrder(con, order);
            		
            		int orderCode = orderDAO.selectLastOrderCode(con);
            
            		List<OrderMenuDTO> orderMenuList = order.getOrderMenuList();
            		for(int i = 0; i <orderMenuList.size(); i++) {
            			OrderMenuDTO orderMenu = orderMenuList.get(i);
            			orderMenu.setOrderCode(orderCode);
            		}
            		
            		int orderMenuResult = 0;
            		for(int i =0; i <orderMenuList.size(); i++) {
            			OrderMenuDTO orderMenu = orderMenuList.get(i);
            			orderMenuResult += orderDAO.registOrderMenu(con, orderMenu);
            		}
            		
            		if(orderResult > 0 && orderMenuResult == orderMenuList.size()) {
            			commit(con);
            			result = 1;
            		} else {
            			rollback(con);
            		}
            
            		close(con);
            		
            		return result;
            	}
            }
            ```
            
    - DAO Layer
        - DBì™€ ì§ì ‘ ê´€ë ¨ëœ CRUD ì‘ì—…ì„ ë‹´ë‹¹í•œë‹¤.
            
            ```java
            package com.greedy.section01.model.dao;
            
            import static com.greedy.common.JDBCTemplate.close;
            
            import java.io.FileInputStream;
            import java.io.IOException;
            import java.sql.Connection;
            import java.sql.PreparedStatement;
            import java.sql.ResultSet;
            import java.sql.SQLException;
            import java.sql.Statement;
            import java.util.ArrayList;
            import java.util.List;
            import java.util.Properties;
            
            import com.greedy.section01.model.dto.CategoryDTO;
            import com.greedy.section01.model.dto.MenuDTO;
            import com.greedy.section01.model.dto.OrderDTO;
            import com.greedy.section01.model.dto.OrderMenuDTO;
            
            public class OrderDAO {
            
            	private Properties prop = new Properties();
            	
            	public OrderDAO() {
            		try {
            			prop.loadFromXML(new FileInputStream("mapper/order-query.xml"));
            		} catch (IOException e) {
            			e.printStackTrace();
            		}
            	}
            
            	public List<CategoryDTO> selectAllCategory(Connection con) {
            		Statement stmt = null;
            		ResultSet rset = null;
            		
            		List<CategoryDTO> categoryList = new ArrayList<>();		// NPE(Null Point Exception ë°©ì§€ ì½”ë“œ
            		
            		String query = prop.getProperty("selectAllCategory");
            
            		try {
            			stmt = con.createStatement();
            			rset = stmt.executeQuery(query);
            			
            			while(rset.next()) {
            				CategoryDTO category = new CategoryDTO();
            				category.setCode(rset.getInt("CATEGORY_CODE"));
            				category.setName(rset.getString("CATEGORY_NAME"));
            				category.setRefCode(rset.getInt("REF_CATEGORY_CODE"));
            				
            				categoryList.add(category);
            			}
            		} catch (SQLException e) {
            			e.printStackTrace();
            		} finally {
            			close(rset);
            			close(stmt);
            		}
            		
            		return categoryList;
            	}
            
            	public List<MenuDTO> selectMenuBy(Connection con, int categoryCode) {
            		PreparedStatement pstmt = null;
            		ResultSet rset = null;
            		
            		List<MenuDTO> menuList = new ArrayList<>();
            		
            		String query = prop.getProperty("selectMenuByCategory");
            		
            		try {
            			pstmt = con.prepareStatement(query);
            			pstmt.setInt(1, categoryCode);
            			
            			rset = pstmt.executeQuery();
            			while(rset.next()) {
            				MenuDTO menu = new MenuDTO();
            				menu.setCode(rset.getInt("MENU_CODE"));
            				menu.setName(rset.getString("MENU_NAME"));
            				menu.setPrice(rset.getInt("MENU_PRICE"));
            				menu.setCategoryCode(rset.getInt("CATEGORY_CODE"));
            				menu.setOrderableStatus(rset.getString("ORDERABLE_STATUS"));
            				
            				menuList.add(menu);
            			}
            			
            		} catch (SQLException e) {
            			e.printStackTrace();
            		} finally {
            			close(rset);
            			close(pstmt);
            		}
            		
            		return menuList;
            	}
            
            	public int registOrder(Connection con, OrderDTO order) {
            		PreparedStatement pstmt = null;
            		int result = 0;
            		
            		String query = prop.getProperty("insertOrder");
            		
            		try {
            			pstmt = con.prepareStatement(query);
            			pstmt.setString(1, order.getDate());
            			pstmt.setString(2, order.getTime());
            			pstmt.setInt(3, order.getTotalOrderPrice());
            			
            			result = pstmt.executeUpdate();
            		} catch (SQLException e) {
            			e.printStackTrace();
            		} finally {
            			close(pstmt);
            		}
            		
            		return result;
            	}
            
            	public int selectLastOrderCode(Connection con) {
            		Statement stmt = null;
            		ResultSet rset = null;
            		
            		int lastOrderCode = 0;
            		
            		String query = prop.getProperty("selectLastOrderCode");
            		
            		try {
            			stmt = con.createStatement();
            			rset = stmt.executeQuery(query);
            			if(rset.next()) {
            				lastOrderCode = rset.getInt("CURRVAL");
            			}
            		} catch (SQLException e) {
            			e.printStackTrace();
            		} finally {
            			close(rset);
            			close(stmt);
            		}
            		
            		return lastOrderCode;
            	}
            
            	public int registOrderMenu(Connection con, OrderMenuDTO orderMenu) {
            		PreparedStatement pstmt = null;
            		int result = 0;
            		
            		String query = prop.getProperty("insertOrderMenu");
            		
            		try {
            			pstmt = con.prepareStatement(query);
            			pstmt.setInt(1, orderMenu.getOrderCode());
            			pstmt.setInt(2, orderMenu.getMenuCode());
            			pstmt.setInt(3, orderMenu.getAmount());
            			
            			result = pstmt.executeUpdate();
            		} catch (SQLException e) {
            			e.printStackTrace();
            		} finally {
            			close(pstmt);
            		}
            		
            		return result;
            	}
            }
            ```
            
    - DB Layer
        - í”„ë¡œê·¸ë¨ì—ì„œ ì‚¬ìš©í•  ì •ë³´ë“¤ì´ ë‹´ê¸´ ê³µê°„.
            
            ```java
            -- ì‹œí€€ìŠ¤ ìƒì„±
            DROP SEQUENCE SEQ_CATEGORY_CODE;
            DROP SEQUENCE SEQ_MENU_CODE;
            DROP SEQUENCE SEQ_ORDER_CODE;
            DROP SEQUENCE SEQ_PAYMENT_CODE;
            
            CREATE SEQUENCE SEQ_CATEGORY_CODE;
            CREATE SEQUENCE SEQ_MENU_CODE;
            CREATE SEQUENCE SEQ_ORDER_CODE;
            CREATE SEQUENCE SEQ_PAYMENT_CODE;
            
            -- í…Œì´ë¸” ìƒì„±
            DROP TABLE tbl_category CASCADE CONSTRAINTS;
            DROP TABLE tbl_menu CASCADE CONSTRAINTS;
            DROP TABLE tbl_order CASCADE CONSTRAINTS;
            DROP TABLE tbl_order_menu CASCADE CONSTRAINTS;
            DROP TABLE tbl_payment CASCADE CONSTRAINTS;
            DROP TABLE tbl_payment_order;
            
            -- category í…Œì´ë¸” ìƒì„±
            CREATE TABLE tbl_category
            (
                category_code    NUMBER NOT NULL,
                category_name    VARCHAR2(30) NOT NULL,
                ref_category_code    NUMBER
            );
            
            COMMENT ON COLUMN tbl_category.category_code IS 'ì¹´í…Œê³ ë¦¬ì½”ë“œ';
            COMMENT ON COLUMN tbl_category.category_name IS 'ì¹´í…Œê³ ë¦¬ëª…';
            COMMENT ON COLUMN tbl_category.ref_category_code IS 'ìƒìœ„ì¹´í…Œê³ ë¦¬ì½”ë“œ';
            COMMENT ON TABLE tbl_category IS 'ì¹´í…Œê³ ë¦¬';
            
            CREATE UNIQUE INDEX index_category_code ON tbl_category
            ( category_code );
            
            ALTER TABLE tbl_category
             ADD CONSTRAINT pk_category_code PRIMARY KEY ( category_code )
             USING INDEX index_category_code;
            
            ALTER TABLE tbl_category
             ADD CONSTRAINT fk_ref_category_code FOREIGN KEY ( ref_category_code )
             REFERENCES tbl_category ( category_code);
            
            CREATE TABLE tbl_menu
            (
                menu_code    NUMBER NOT NULL,
                menu_name    VARCHAR2(30) NOT NULL,
                menu_price    NUMBER NOT NULL,
                category_code    NUMBER NOT NULL,
                orderable_status    CHAR(1) NOT NULL
            );
            
            COMMENT ON COLUMN tbl_menu.menu_code IS 'ë©”ë‰´ì½”ë“œ';
            COMMENT ON COLUMN tbl_menu.menu_name IS 'ë©”ë‰´ëª…';
            COMMENT ON COLUMN tbl_menu.menu_price IS 'ë©”ë‰´ê°€ê²©';
            COMMENT ON COLUMN tbl_menu.category_code IS 'ì¹´í…Œê³ ë¦¬ì½”ë“œ';
            COMMENT ON COLUMN tbl_menu.orderable_status IS 'ì£¼ë¬¸ê°€ëŠ¥ìƒíƒœ';
            COMMENT ON TABLE tbl_menu IS 'ë©”ë‰´';
            
            CREATE UNIQUE INDEX index_menu_code ON tbl_menu
            ( menu_code );
            
            ALTER TABLE tbl_menu
             ADD CONSTRAINT pk_menu_code PRIMARY KEY ( menu_code )
             USING INDEX index_menu_code;
            
            ALTER TABLE tbl_menu
             ADD CONSTRAINT fk_category_code FOREIGN KEY ( category_code )
             REFERENCES tbl_category ( category_code );
            
            CREATE TABLE tbl_order
            (
                order_code    NUMBER NOT NULL,
                order_date    VARCHAR2(8) NOT NULL,
                order_time    VARCHAR2(8) NOT NULL,
                total_order_price    NUMBER NOT NULL
            );
            
            COMMENT ON COLUMN tbl_order.order_code IS 'ì£¼ë¬¸ì½”ë“œ';
            COMMENT ON COLUMN tbl_order.order_date IS 'ì£¼ë¬¸ì¼ì';
            COMMENT ON COLUMN tbl_order.order_time IS 'ì£¼ë¬¸ì‹œê°„';
            COMMENT ON COLUMN tbl_order.total_order_price IS 'ì´ì£¼ë¬¸ê¸ˆì•¡';
            COMMENT ON TABLE tbl_order IS 'ì£¼ë¬¸';
            
            CREATE UNIQUE INDEX index_order_code ON tbl_order
            ( order_code );
            
            ALTER TABLE tbl_order
             ADD CONSTRAINT pk_order_code PRIMARY KEY ( order_code )
             USING INDEX index_order_code;
            
            CREATE TABLE tbl_order_menu
            (
                order_code NUMBER NOT NULL,
                menu_code    NUMBER NOT NULL,
                order_amount    NUMBER NOT NULL
            );
            
            COMMENT ON COLUMN tbl_order_menu.order_code IS 'ì£¼ë¬¸ì½”ë“œ';
            COMMENT ON COLUMN tbl_order_menu.menu_code IS 'ë©”ë‰´ì½”ë“œ';
            COMMENT ON COLUMN tbl_order_menu.order_amount IS 'ì£¼ë¬¸ìˆ˜ëŸ‰';
            COMMENT ON TABLE tbl_order_menu IS 'ì£¼ë¬¸ë³„ë©”ë‰´';
            CREATE UNIQUE INDEX index_comp_order_menu_code ON tbl_order_menu
            ( order_code,menu_code );
            
            ALTER TABLE tbl_order_menu
             ADD CONSTRAINT pk_comp_order_menu_code PRIMARY KEY ( order_code, menu_code )
             USING INDEX index_comp_order_menu_code;
            
            ALTER TABLE tbl_order_menu
             ADD CONSTRAINT fk_order_menu_order_code FOREIGN KEY ( order_code )
             REFERENCES tbl_order ( order_code );
            
            ALTER TABLE tbl_order_menu
             ADD CONSTRAINT fk_order_menu_menu_code FOREIGN KEY ( menu_code )
             REFERENCES tbl_menu ( menu_code );
             
            CREATE TABLE tbl_payment
            (
                payment_code    NUMBER NOT NULL,
                payment_date    VARCHAR2(8) NOT NULL,
                payment_time    VARCHAR2(8) NOT NULL,
                payment_price    NUMBER NOT NULL,
                payment_type    VARCHAR2(6) NOT NULL
            );
            
            COMMENT ON COLUMN tbl_payment.payment_code IS 'ê²°ì œì½”ë“œ';
            COMMENT ON COLUMN tbl_payment.payment_date IS 'ê²°ì œì¼';
            COMMENT ON COLUMN tbl_payment.payment_time IS 'ê²°ì œì‹œê°„';
            COMMENT ON COLUMN tbl_payment.payment_price IS 'ê²°ì œê¸ˆì•¡';
            COMMENT ON COLUMN tbl_payment.payment_type IS 'ê²°ì œêµ¬ë¶„';
            COMMENT ON TABLE tbl_payment IS 'ê²°ì œ';
            
            CREATE UNIQUE INDEX index_payment_code ON tbl_payment
            ( payment_code );
            
            ALTER TABLE tbl_payment
             ADD CONSTRAINT pk_payment_code PRIMARY KEY ( payment_code)
             USING INDEX index_payment_code;
            
            CREATE TABLE tbl_payment_order
            (
                order_code    NUMBER NOT NULL,
                payment_code    NUMBER NOT NULL
            );
            
            COMMENT ON COLUMN tbl_payment_order.order_code IS 'ì£¼ë¬¸ì½”ë“œ';
            COMMENT ON COLUMN tbl_payment_order.payment_code IS 'ê²°ì œì½”ë“œ';
            COMMENT ON TABLE tbl_payment_order IS 'ê²°ì œë³„ì£¼ë¬¸';
            
            CREATE UNIQUE INDEX index_comp_payment_order_code ON tbl_payment_order
            ( payment_code,order_code );
            
            ALTER TABLE tbl_payment_order
             ADD CONSTRAINT pk_comp_payment_order_code PRIMARY KEY ( payment_code,order_code )
             USING INDEX index_comp_payment_order_code;
            
            INSERT INTO TBL_CATEGORY VALUES (SEQ_CATEGORY_CODE.NEXTVAL, 'ì‹ì‚¬', null);
            INSERT INTO TBL_CATEGORY VALUES (SEQ_CATEGORY_CODE.NEXTVAL, 'ìŒë£Œ', null);
            INSERT INTO TBL_CATEGORY VALUES (SEQ_CATEGORY_CODE.NEXTVAL, 'ë””ì €íŠ¸', null);
            INSERT INTO TBL_CATEGORY VALUES (SEQ_CATEGORY_CODE.NEXTVAL, 'í•œì‹', 1);
            INSERT INTO TBL_CATEGORY VALUES (SEQ_CATEGORY_CODE.NEXTVAL, 'ì¤‘ì‹', 1);
            
            INSERT INTO TBL_CATEGORY VALUES (SEQ_CATEGORY_CODE.NEXTVAL, 'ì¼ì‹', 1);
            INSERT INTO TBL_CATEGORY VALUES (SEQ_CATEGORY_CODE.NEXTVAL, 'í“¨ì „', 1);
            INSERT INTO TBL_CATEGORY VALUES (SEQ_CATEGORY_CODE.NEXTVAL, 'ì»¤í”¼', 2);
            INSERT INTO TBL_CATEGORY VALUES (SEQ_CATEGORY_CODE.NEXTVAL, 'ì¥¬ìŠ¤', 2);
            INSERT INTO TBL_CATEGORY VALUES (SEQ_CATEGORY_CODE.NEXTVAL, 'ê¸°íƒ€', 2);
            
            INSERT INTO TBL_CATEGORY VALUES (SEQ_CATEGORY_CODE.NEXTVAL, 'ë™ì–‘', 3);
            INSERT INTO TBL_CATEGORY VALUES (SEQ_CATEGORY_CODE.NEXTVAL, 'ì„œì–‘', 3);
            
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ì—´ë¬´ê¹€ì¹˜ë¼ë–¼', 4500, 8, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ìš°ëŸ­ìŠ¤ë¬´ë””', 5000, 10, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ìƒê°ˆì¹˜ì‰ì´í¬', 6000, 10, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ê°ˆë¦­ë¯¸ì—­íŒŒë¥´í˜', 7000, 10, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ì•™ë²„í„°ê¹€ì¹˜ì°œ', 13000, 7, 'Y');
            
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ìƒë§ˆëŠ˜ìƒëŸ¬ë“œ', 12000, 4, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ë¯¼íŠ¸ë¯¸ì—­êµ­', 15000, 4, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'í•œìš°ë”¸ê¸°êµ­ë°¥', 20000, 4, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'í™ì–´ë§ˆì¹´ë¡±', 9000, 12, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ì½”ë‹¤ë¦¬ë§ˆëŠ˜ë¹µ', 7000, 12, 'Y');
            
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ì •ì–´ë¦¬ë¹™ìˆ˜', 10000, 10, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ë‚ ì¹˜ì•ŒìŠ¤í¬ë¥˜ë°”', 2000, 10, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ì§í™”êµ¬ì´ì ¤ë¼ë˜', 8000, 12, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ê³¼ë©”ê¸°ì»¤í‹€ë¦¿', 13000, 6, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ì£½ë°©ë©¸ì¹˜íŠ€ê¹€ìš°ë™', 11000, 6, 'Y');
            
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'í‘ë§ˆëŠ˜ì•„ë©”ë¦¬ì¹´ë…¸', 9000, 8, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ì•„ì´ìŠ¤ê°€ë¦¬ë¹„ê´€ììœ¡ìˆ˜', 6000, 10, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ë¶•ì–´ë¹µì´ˆë°¥', 35000, 6, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ê¹Œë‚˜ë¦¬ì½”ì½”ë„›ì¥¬ìŠ¤', 9000, 9, 'Y');
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ë§ˆë¼ê¹ì‡¼í•œë¼ë´‰', 22000, 5, 'Y');
            
            INSERT INTO TBL_MENU VALUES (SEQ_MENU_CODE.NEXTVAL, 'ëŒë¯¸ë‚˜ë¦¬ë°±ì„¤ê¸°', 5000, 12, 'Y');
            
            COMMIT;
            ```
            
- ëª¨ë¸ë§ ê³¼ì •ì— ë”°ë¥¸ DTO ì°¸ì¡°
    - ëª¨ë¸ë§ ê³¼ì •ì— ë”°ë¼ DTOì˜ ì°¸ì¡°êµ¬ì¡°ê°€ ë‹¬ë¼ì§„ë‹¤.
        
        ![Untitled](JDBC%20%E1%84%80%E1%85%AD%E1%84%8B%E1%85%B2%E1%86%A8%20574344152fda4b59b798121d66bfcc3d/Untitled%208.png)
        
        - ìœ„ ì½”ë“œì˜ ê²½ìš°, OrderMenuDTO Classì˜ orderCodeëŠ” OrderDTOì˜ codeë¥¼ ì°¸ì¡°í•˜ëŠ” FKì¸ ë™ì‹œì— OrderMenuDTOì˜ FKë‹¤. ì´ë¥¼ PFK, ë³µí•©í‚¤ë¼ê³ ë„ í•œë‹¤.

---

[ë‹¨ìœ„ í…ŒìŠ¤íŠ¸](JDBC%20%E1%84%80%E1%85%AD%E1%84%8B%E1%85%B2%E1%86%A8%20574344152fda4b59b798121d66bfcc3d/%E1%84%83%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B1%20%E1%84%90%E1%85%A6%E1%84%89%E1%85%B3%E1%84%90%E1%85%B3%20ebd74531fcf74384857cb904b7adc6e9.md)