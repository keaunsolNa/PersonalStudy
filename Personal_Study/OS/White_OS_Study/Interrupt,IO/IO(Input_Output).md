# I/O(Input/Output)

# Definition

- 입력(Input)은 시스템이 수신한 신호 또는 데이터이며, 출력(Output)은 시스템에서 전송한 신호 또는 데이터이다.
- 내부 저장소와 외부 I/O 장치 간에 정보를 전송하는 데 사용되는 방법을 I/O 인터페이스라고 한다.
- 사람(또는 다른 시스템)이 컴퓨터와 통신하는 데 사용하는 하드웨어를 I/O 장치라고 한다.
- I/O는 개별 시스템 간의 데이터 공유를 지원하기 위해 올바르게 실행되어야 하는 다양한 작업을 포함한다. 시스템 내의 모든 유형의 데이터 이동은 오디오 파일, 소프트웨어 명령 세트, 텍스트 및 비디오 스트림을 포함한 I/O 작업에 의존한다.

# I/O Devices

- I/O 장치는 일반적으로 컴퓨터와 인터페이스하기 위해 개별 시스템을 사용하는 스토리지, 네트워크 통신, 사용자 인터페이스 또는 관련 하드웨어 서비스로 분류된다.
- 통신을 위해 장치는 병렬 또는 직렬 I/O 포트나 무선 신호를 사용한다.
- 입력/출력은 하드 I/O와 소프트 I/O의 두 가지 범주로 분류된다.
- 하드 I/O는 컴퓨터와 키보드나 마우스 같은 외부 물리적 장치 사이에서 발생하는 직접적인 데이터 전송을 의미한다.
- 소프트 I/O는 스트리밍 미디어나 파일 공유와 같이 네트워크를 통해 컴퓨터나 서버 간에 데이터가 전송될 때 발생한다.
- I/O 작업은 초당 발생하는 작업수(IOPS[Input/Output Operations Persecond]) 또는 전송 속도 측정 기준으로 계산된다. I/O 성능은 드라이브, 그래픽 카드, 네트워크 장비 등 컴퓨터 내부 장비의 성능에 영향을 받는다.

# I/O Memory Management(Interface)

![Untitled](IO(Input_Output)/Untitled.png)

- 내부 저장소와 외부 I/O 장치 간에 정보를 전송하는 데 사용되는 방법을 I/O 인터페이스라고 한다.
- 일반적으로 CPU는 버스(Bus, Data highway, databus)를 통해 장치와 통신한다. 이러한 통신 링크는 CPU와 주변 장치 간의 차이점을 해결하는 데 사용된다. CPU와 주변 장치 사이에는 인터페이스 장치라고 하는 모든 입력 및 출력 전송을 감독하고 동기화하는 특수 하드웨어 구성 요소가 있다.
- 최신 컴퓨팅 시스템은 시스템 버스와 연결된 주변 장치 사이에 I/O 프로세서가 위치하는 경우가 많다. I/O 프로세서는 데이터 전송과 관련된 작업을 처리하기 위해 장착되었다.
- I/O 장치와 프로세서 간의 통신을 용이하게 하기 위해 I/O 인터페이스는 CPU에서 생성된 모든 주소를 식별한다. 컨트롤러는 데이터가 컴퓨터의 다양한 구성 요소로 전송되도록 한다.
- 사용되는 제어 방법은 다음과 같다.
    
    ### Programmed I/O(PIO)
    
    - 프로세서가 모든 I/O 전송에 대해 명령을 실행해야 한다. 가장 느리지만 프로그래밍 하기 가장 간단하다.
    - 컴퓨터 프로그램에 작성된 I/O 명령의 결과로 인한 것이다. 각 데이터 항목 전송은 프로그램의 명령에 의해 시작된다.
    - 전송은 일반적으로 CPU 레지스터와 메모리에서 이루어진다. 이 경우 주변 장치의 CPU에 의한 지속적인 모니터링이 필요하다.
    - I/O 장치는 PIO의 경우 메모리 장치에 직접 액세스할 수 없다. I/O 장치에서 메모리로의 전송에는 장치에서 CPU로 데이터를 전송하는 입력 명령과 CPU에서 메모리로 데이터를 전송하느 저장 명령을 포함하여 CPU가 여러 명령을 실행해야 한다.
    - CPU는 I/O 장치가 데이터 전송 준비가 되었음을 나타낼 때까지 프로그램 루프에 유지된다. 불필요하게 CPU를 바쁘게 유지하므로 시간이 많이 걸리는 프로세스다.
    
    ### Interrupt-driven I/O
    
    - I/O 장치가 데이터를 수신할 준비가 되었을 때 인터럽트 기능과 특수 명령을 사용하여 모든 장치에서 데이터를 사용할 수 있을 때마다 인터럽트 요청 신호를 발행하도록 인터페이스에 명령을 보낸다.
    - 그 뒤 CPU는 이전 활동을 재개하기 전에 새로운 명령을 수행하기 위해 수행 중인 작업을 일시적으로 일시 중지한다.
    - 그 동안 인터페이스는 장치를 계속 모니터링한다. 장치가 데이터 전송 준비가 되었다고 판단될 때마다 컴퓨터에 인터럽트 요청 신호를 보낸다.
    - 외부 인터럽트 신호가 감지되면 CPU는 이미 수행 중이던 작업을 잠시 중지하고 서비스 프로그램으로 분기하여 I/O 전송을 처리한 후 원래 수행하던 작업으로 돌아간다.
    - CPU는 I/O 장치의 수신 상태를 확인할 필요가 없다.
    
    ### Advanced Programmable Interrupt Controller (APIC)
    
    - APIC에 인터럽트 신호를 보내 장치가 데이터를 보낼 준비가 되면 프로세서에 알린다.
    - 대량의 인터럽트를 처리하고 각 인터럽트를 특정 사용 가능한 CPU 세트에 프로그래밍 방식으로 라우팅할 수 있도록 개발되었다.
    - CPU간 통신을 지원하고 단일 인터럽트 라인을 공유하기 위해 많은 수의 장치가 필요하지 않다.
    - 확장 가능하고 관리 가능한 방식으로 다수의 하드웨어 인터럽트를 생성, 라우팅 및 처리하기 위해 함께 작동하는 일련의 장치 및 기술을 나타낸다.
    
    ### Direct memory access (DMA)
    
    ![Untitled](IO(Input_Output)/Untitled%201.png)
    
    - 자기 디스크와 같은 빠른 저장 매체와 메모리 장치 간의 데이터 전송은 CPU 속도에 의해 제한된다. 따라서 메모리 버스를 사용하여 주변 장치가 서로 직접 통신할 수 있게 하여 CPU의 개입을 제거할 수 있다. 이러한 유형의 데이터 전송 기술이 DMA.
    - DMA는 CPU를 우회하여 주변 장치에서 주 메모리로 데이터 명령을 보낸다. DMA는 CPU가 모든 데이터 트랜잭션을 관리하는 프로세스인 PIO를 대체한다.
    - DMA 동안 CPU는 유휴 상태이며 메모리 버스를 제어할 수 없다.
    - DMA 컨트롤러는 버스를 대신하여 I/O 장치와 메모리 장치 간의 전송을 직접 관리한다.
    
    ### Input-output memory machine unit (IOMMU)
    
    - 가상 머신용으로 설계되었으며 운영 체제가 물리적 장치와 가상 장치의 매핑을 상호 연결하여 메모리 리소스를 효율적으로 할당할 수 있다.
    - 운영 체제가 가상 머신 내에서 실행될 때 일반적으로 액세스하는 메모리의 물리적 주소를 알지 못하기에 컴퓨터 하드웨어에 접근하기가 어렵다. IOMMU는 하드웨어가 액세스하는 주소를 다시 매핑하여 이 문제를 해결한다.
    - IOMMU는 IOVA(I Virtual Address)라는 또 다른 가상 주소를 실제 주소로 변환한다. IOVA를 사용하여 장치가 메모리를 덮어쓰는 것을 방지할 수 있다.

# I/O Bus

![Untitled](IO(Input_Output)/Untitled%202.png)

- 프로세서에서 발생하고 I/O 장치와 통신하도록 의도된 데이터 버스, 주소 버스 및 제어 버스를 I/O 버스라고 한다.
- I/O 버스는 주변 장치가 컴퓨터 프로세서와 상호 작용하는 데 사용되는 경로다.
- I/O 버스에는 데이터 라인, 주소 라인, 제어 라인이 포함된다.
- 주변 장치로부터 수신된 주소와 제어를 설명할 수 있으며 주변 장치 컨트롤러에 대한 신호를 지원한다. 또한 주변 장치와 프로세서 간의 정보 전송을 수행하고 데이터 흐름을 통합한다.
- I/O 버스는 프로세서의 모든 주변 장치 인터페이스에 연결된다. 프로세서는 특정 장치와 상호 작용하기 위해 주소 표시줄에서 장치 주소를 찾는다. 각 인터페이스에는 주소 라인을 모니터링하는 I/O 버스에 연결된 주소 디코더가 포함되어 있다.
- 인터페이스가 주소를 인식하면 버스 라인과 제어하는 장치 사이의 경로가 활성화된다. 인터페이스는 주소가 버스의 주소와 동일하지 않은 주변 장치를 비활성화한다.
- 동시에 I/O 명령이라고 불리는 기능 코드가 제어 버스에 제공된다. 프로세서가 제공하는 I/O 명령 유형은 다음과 같다.
    - 제어 명령
        - 해당 주변 장치를 활성화하고 수행할 작업을 알려주는 기능 코드
    - 상태 명령
        - BUSY, ERROR, 버퍼에서 데이터 사용 가능 여부 등과 같은 인터페이스 및 주변 장치의 다양한 상태 조건을 테스트하는 데 사용
    - 데이터 출력 명령
        - 데이터 출력 명령은 프로세서에서 주변 장치로 데이터를 전송하여 인터페이스가 응답하도록 한다. 데이터 출력 명령이 제공되면 데이터가 CPU에서 인터페이스의 버퍼로 전송된다.
    - 데이터 입력 명령
        - 주변 장치에서 데이터를 읽어야 하는 경우 CPU에서 전송된다. 명령이 실행된 후 주변 장치의 데이터가 인터페이스 버퍼로 추출되어 CPU에서 읽혀진다.