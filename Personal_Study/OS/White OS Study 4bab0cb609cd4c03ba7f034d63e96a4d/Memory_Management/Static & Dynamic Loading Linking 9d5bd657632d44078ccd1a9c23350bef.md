# Static & Dynamic Loading/Linking

![Untitled](Static%20&%20Dynamic%20Loading%20Linking%209d5bd657632d44078ccd1a9c23350bef/Untitled.png)

# Loading & Linking

- Loading과 Linking은 모두 프로그램 실행에 중요한 역할을 하는 유틸리티 프로그램이다.
- Linking은 어셈블러에서 생성된 개체 코드를 가져와 실행 가능한 모듈을 생성한다.
    - 프로그램 실행을 계속하기 위해 프로그램의 모든 모듈이나 모든 기능 사이에 링크를 설정하는 것을 링크라고 한다.
    - 링크는 코드와 데이터 조각을 단일 파일로 수집하고 유지하는 프로세스다.
    - 특정 모듈을 시스템 라이브러리에 연결한다.
    - 어셈블러의 개체 모듈을 입력으로 사용하고 로더의 출력으로 실행 파일을 형성한다.
    - 컴파일 타임과 로드 타임에 모두 수행되며, 프로그램 컴파일의 마지막 단계에서 수행된다.
    - 정적 연결과 동적 연결이 있다.
- Loading은 실행을 위해 실행 가능한 모듈을 주 메모리에 로드한다.
    - 프로그램을 보조 메모리에서 주 메모리로 가져오는 것을 로딩(Loading)이라고 한다.
    - 로더에 의해 수행되며 Linker에서 실행 파일의 입력을 받아 이를 주 메모리에 로드하고 컴퓨터에서 실행할 수 있도록 코드를 준비하는 특수 프로그램이다.
    - 정적 로딩과 동적 로딩이 있다.
    
    | Linking | Loading |
    | --- | --- |
    | 코드와 데이터 조각을 단일 파일로 수집하고 유지 관리하는 프로세스를 운영 체제에서는 연결이라고 한다. | 로딩은 실행을 위해 보조 메모리에서 주 메모리로 프로그램을 로드하는 프로세스다. |
    | 연결은 모든 모듈을 결합하는 데 사용된다. | 로딩은 모든 실행 파일에 주소를 할당하는 데 사용되며 이 작업은 로더에 의해 수행된다. |
    | 링커의 도움으로 연결이 수행된다.https://www.geeksforgeeks.org/operating-systems/운영 체제 에서 링커는 프로그램의 개체 모듈을 단일 개체 파일로 연결하는 데 도움이 되는 프로그램이다. 링크 편집기라고도 한다. | 로더는 프로그램을 메모리에 배치 하고 실행을 준비하는 프로그램이다 . |
    | 링커는 별도의 컴파일을 가능하게 하기 때문에 소프트웨어 개발 프로세스에서 중요한 부분이다.
    대규모 애플리케이션을 하나의 모놀리식 소스 파일로 구성하는 것 외에도 별도로 수정하고 컴파일할 수 있는 더 작고 관리하기 쉬운 모듈로 분해할 수 있다 . | 로더는 운영 체제의 할당, 연결, 재배치 및 로딩을 담당한다. |

# Dynamic Linking & Static Linking

![Untitled](Static%20&%20Dynamic%20Loading%20Linking%209d5bd657632d44078ccd1a9c23350bef/Untitled%201.png)

### Dynamic

- 동적 연결에서는 외부 라이브러리의 이름을 확인되지 않은 기호로 최종 실행 파일에 복사한다.
- 그 뒤 런타임에만 이러한 해결되지 않은 기호를 실제로 연결한다.
- 이는 해결되지 않은 기호를 발견할 시 RAM에 이를 쿼리함으로써 이루어진다.
- 해당 라이브러리가 로드되지 않으면 OS는 해당 라이브러리를 메모리에 로드한다.
- Dynamic Linking은 다음의 이점을 가진다
    - 동적 연결에서는 공유 라이브러리의 복사본 하나만 메모리에 유지된다.
        - 따라서 프로그램의 실행 파일이 정적 연결에 비해 더 작으며, 메모리 효율성이 더 높다.
    - 평균 로드 시간이 단축된다.
    - 배포 및 유지 관리 관점에서 수월해진다
    - 모듈성을 촉진한다.
    
    ### DDL Hell Issuae
    
    - DDL(동적으로 링크된 라이브러리) 지옥 문제는 OS가 로드하는 DDL이 응용 프로그램의 기대하는 버전과 다를 때 발생한다. 이는 해결되지 않는 기호를 만든다.
    - 애플리케이션이 사용하는 API를 변경했지만, 애플리케이션의 API를 사용하는 코드를 업데이트 하는 것을 잊어버린 경우, 애플리케이션이 이전 API를 호출하게 됨으로써 런타임 시 충돌이 발생한다.
    - DDL에는 이전 버전과의 호환성을 확인하는 기본 제공 메커니즘이 없으므로, DDL을 조금만 변경해도 이런 문제가 발생할 수 있다.

### Static

- 정적 연결 시 시스템 링커는 종속성을 최종 실행 파일에 복사한다.
- 외부 라이브러리를 연결할 때 링커는 해당 라이브러리에 정의된 모든 종속성을 찾으며 이를 라이브러리의 해당 함수로 대체하여 코드의 종속성을 해결한다.
- 그 후 링크는 기본 컴퓨터에서 실행할 수 있는 최종 실행 파일을 생성한다.
- 위 과정으로 인해 정적으로 링크된 파일에는 프로그램의 코드뿐만 아니라 호출하는 모든 라이브러리의 코드도 포함된다. 이로 인해 결과 파일이 매우 커질 수 있으므로 디스크와 주 메모리 모두에 공간이 필요하다.
- Static Linking은 다음의 이점을 가진다
    - 정적 링크는 컴파일 타임에 외부 라이브러리를 통합하므로 애플리케이션이 독립 실행형 바이너리로 실행될 수 있도록 보장한다
    - 독점성을 보장한다
        - 정적으로 연결된 각 프로세스는 코드와 데이터의 복사본을 가져옴으로써 각각 독립적인 환경을 제공, 프로세스를 다른 프로세스와 완전히 격리할 수 있다
    - 정적으로 링크된 애플리케이션의 경우 모든 것을 애플리케이션에 묶는다. 따라서 클라이언트에서 라이브러리의 버전 관리를 할 필요성이 줄어든다.
    - 정적 링크는 컴파일 타임에 전체 라이브러리 내용을 복사하기에 더 빠른 실행을 제공한다.
    
    | 정적 연결 | 동적 연결 |
    | --- | --- |
    | 컴파일 타임에 필요한 모든 라이브러리 루틴과 외부 참조를 단일 실행 파일로 결합하는 프로세스. | 프로그램이 로드되거나 실행될 때 런타임에 외부 라이브러리와 참조를 연결하는 프로세스. |
    | 컴파일 타임에 발생. | 런타임에 발생. |
    | 모든 필수 라이브러리가 실행 파일에 포함되어 있으므로 일반적으로 파일 크기가 더 크다. | 라이브러리가 런타임에 동적으로 연결되므로 파일 크기가 더 작다. |
    | 라이브러리를 업데이트하거나 변경하려면 전체 프로그램을 다시 컴파일하고 다시 연결해야 하므로 유연성이 떨어진다. | 프로그램을 다시 컴파일하지 않고도 라이브러리를 업데이트하거나 교체할 수 있으므로 더욱 유연하다. |
    | 모든 라이브러리가 이미 연결되어 있으므로 프로그램 시작 및 직접 실행이 더 빨라진다. | 추가 연결 프로세스로 인해 프로그램 시작 속도가 약간 느려지지만 전반적인 성능에 미치는 영향은 미미하다. |
    | .exe, .elf, .a, .lib 등과 같은 파일 확장자를 가진 실행 파일 | .dll, .so, .dylib 등과 같은 파일 확장자를 가진 실행 파일 |

# Dynamic Loading & Static Loading

### Dynamic

- 프로세스를 실행하는 동안 전체 프로그램과 필요한 프로세스 데이터는 물리적 메모리 크기에 따라 프로세스 크기가 제한되는 물리적 메모리에 있어야 한다. 물리적 메모리를 적절하게 활용하기 위해 동적 로더가 등장한다.
- 동적 로더는 요청 시 프로그램을 주 메모리에 로드하는 프로그램이다
- 동적 로더는 프로그램에서 필요한 코드와 데이터만 로드하고 나머지 부분은 실행 파일에 남겨둔다
- 동적 로더는 모든 외부 종속성을 해결한다
- 동적 로더는 대량의 데이터를 효율적으로 처리해야 할 때 매우 유용하다

### Static

- 정적 로더는 프로그램이 실행되기 전에 프로그램에 필요한 라이브러리, 종속성 등 전체 실행 프로그램을 메모리에 로더(Loader)한다.
- 프로그램을 메모리에 로드한 후 로더는 프로그램의 모든 외부 종속성을 해결한다. (정적 연결)
- 연결이 완료되면 로더는 프로그램의 주소를 업데이트한다.
- 전체 프로그램을 로드하고 연결하는 데 추가 소프트웨어가 필요하지 않다
- 정적 로더에는 정적 링크가 적용된다
- 정적 로더는 프로그램에서 사용하는 실행 파일 형식을 지원하는 모든 플랫폼에서 작동할 수 있으며, 이식 가능하다.

| Dynamic Loader | Static Loader |
| --- | --- |
| 정적 로더는 실행이 시작되기 전에 전체 프로그램을 메모리에 로드한다 | 동적 로더는 프로그램 실행에 필요한 부분만 로드한다. |
| 런타임 연결이 필요하지 않다. | 런타임 연결이 필요하다. |
| 정적 로더의 경우에 사용된다. | 동적 로더의 경우 동적 링킹이 사용된다. |
| 실행 중에 파일이 변경되지 않으므로 더 빠르다. | 런타임에 파일이 업로드되므로 파일 속도가 느려진다. |
| 정적 로더는 메모리 낭비를 만든다. | 동적 메모리는 메모리 효율적이다. |
| 고성능 애플리케이션에 적합하다. | 이는 자원 제약 애플리케이션에 적합하다. |
| 런타임 오류를 제거한다. | 필요한 종속성을 사용할 수 없는 경우 런타임 오류가 발생할 수 있다. |
| 정적 로더는 컴파일러 언어에 사용된다. | 해석된 언어에 사용된다. |
| 전체 프로그램을 메모리에 로드하므로 유연성이 떨어진다. | 더 유연하다. |
| 전체 프로그램과 종속성이 메모리에 한 번 로드되므로 더 예측 가능하다. | 정적 로더보다 예측 가능성이 낮다. |
| 정적 로더에는 더 많은 디스크 공간이 필요하다. | 동적 로더에는 더 적은 디스크 공간이 필요하다. |